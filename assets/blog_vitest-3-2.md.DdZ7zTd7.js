import{_ as k,b as p,o as e,i as r,R as h,ax as E,ay as d,az as o,j as s,g as l,w as a,S as n}from"./chunks/framework.XDTXXE-5.js";const is=JSON.parse('{"title":"Vitest 3.2 发布了！","description":"","frontmatter":{"title":"Vitest 3.2 发布了！","author":{"name":"Vitest 团队"},"date":"2025-06-02T00:00:00.000Z","sidebar":false,"head":[["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:title","content":"Vitest 3.2 发布了!"}],["meta",{"property":"og:image","content":"https://cn.vitest.dev/og-vitest-3-2.png"}],["meta",{"property":"og:url","content":"https://cn.vitest.dev/blog/vitest-3-2"}],["meta",{"property":"og:description","content":"Vitest 3.2 发布公告"}],["meta",{"name":"twitter:card","content":"summary_large_image"}]]},"headers":[],"relativePath":"blog/vitest-3-2.md","filePath":"blog/vitest-3-2.md","lastUpdated":1771601921000}'),g={name:"blog/vitest-3-2.md"},y={class:"language-ts"},F={class:"shiki shiki-themes github-light github-dark twoslash lsp",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabindex:"0",dir:"ltr"},c={class:"line"},u={style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},C={class:"line"},m={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},B={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},f={class:"line"},b={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},A={style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},w={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},D={class:"line"},v={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},x={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},T={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},P={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},V={class:"line"},S={style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},I={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},R={class:"line"},q={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},M={style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},j={style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},N={class:"line"},O={style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},$={class:"line"},H={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},L={class:"line"},W={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},U={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},z={class:"line"},G={style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},J={style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}};function Z(K,i,Q,X,Y,_){const t=p("v-menu");return e(),r("div",null,[i[105]||(i[105]=h('<h1 id="vitest-3-2-发布了" tabindex="-1">Vitest 3.2 发布了！ <a class="header-anchor" href="#vitest-3-2-发布了" aria-label="Permalink to “Vitest 3.2 发布了！”">​</a></h1><p><em>2025 年 6 月 2 日</em></p><p><img src="'+E+`" alt="Vitest 3.2 公告封面图"></p><p>Vitest 3.2 专注于改进浏览器模式和 TypeScript 支持。此版本还包含一些新的实用方法、配置选项，并弃用了 <code>workspace</code> 配置，转而推荐使用 <code>projects</code>。</p><h2 id="workspace-is-deprecated" tabindex="-1"><code>workspace</code> 已弃用 <a class="header-anchor" href="#workspace-is-deprecated" aria-label="Permalink to “workspace 已弃用”">​</a></h2><p>为了简化配置，团队决定弃用单独的 <code>vitest.workspace</code> 文件，推荐仅在根配置中使用 <code>projects</code> 选项。这也简化了全局选项的配置方式（因为当你没有根配置时，不需要再猜测如何添加报告器）。</p><p>我们还决定弃用 <code>workspace</code> 这个名称，因为它与 PNPM 等工具通过该选项提供 monorepo 支持功能存在冲突。Vitest 不会为这些项目分配独立的 <code>工作目录（CWD）</code>，而是将其视为子 Vitest 实例。这也为我们提供了更多空间，以便在不破坏其他功能的情况下为 monorepo 提供更好的解决方案。</p><p>此选项将在未来的主版本中完全移除，由 <code>projects</code> 取代。在此之前，如果使用了 workspace 功能，Vitest 将打印警告。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark has-diff" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vitest/config&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // &quot;test.workspace&quot; 现已更名为 &quot;test.projects&quot;</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    workspace: [ </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    projects: [ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      { test: { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Unit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      { test: { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Integration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="annotation-api" tabindex="-1">注释 API <a class="header-anchor" href="#annotation-api" aria-label="Permalink to “注释 API”">​</a></h2><p>新的 <a href="/guide/test-annotations.html">注释 API</a> 允许你为任何测试添加自定义消息和附件。这些注释在 UI、HTML、junit、tap 和 GitHub Actions 报告器中可见。如果测试失败，Vitest 还会在 CLI 中打印相关注释。</p><img src="`+d+`"><h2 id="scoped-fixtures" tabindex="-1">作用域固定装置 <a class="header-anchor" href="#scoped-fixtures" aria-label="Permalink to “作用域固定装置”">​</a></h2><p><code>test.extend</code> 固定装置现在可以指定 <code>scope</code> 选项：<code>file</code> 或 <code>worker</code>。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> baseTest.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  db: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({}, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ...setup</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(db)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { scope: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;worker&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p><code>file</code> 固定装置类似于在文件顶层使用 <code>beforeAll</code> 和 <code>afterAll</code>，但如果没有任何测试使用该固定装置，它就不会被调用。</p><p><code>worker</code> 固定装置在每个工作线程中仅初始化一次。但请注意，默认情况下 Vitest 为每个测试创建独立工作线程，因此需要禁用 <a href="/config/isolate.html">隔离模式</a> 才能生效。</p><h2 id="custom-project-name-colors" tabindex="-1">自定义项目名称颜色 <a class="header-anchor" href="#custom-project-name-colors" aria-label="Permalink to “自定义项目名称颜色”">​</a></h2><p>使用 <code>projects</code> 时，你现在可以设置自定义 <a href="/config/name.html">颜色</a>：</p><details class="details custom-block"><summary>配置示例</summary><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    projects: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test: {</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: {</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            label: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;unit&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            color: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;red&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test: {</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: {</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            label: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;browser&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            color: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;green&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          browser: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            enabled: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;playwright&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            instances: [{ browser: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;chromium&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></details><img src="`+o+`"><h2 id="custom-browser-locators-api" tabindex="-1">自定义浏览器定位器 API <a class="header-anchor" href="#custom-browser-locators-api" aria-label="Permalink to “自定义浏览器定位器 API”">​</a></h2><p>当内置定位器无法满足应用需求时。与其降级使用 CSS 选择器，并牺牲 Vitest 定位器 API 提供的重试保护机制，不如推荐你使用 <a href="/api/browser/locators.html#custom-locators"><code>locators.extend</code> API</a> 扩展定位器。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { locators } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser/context&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locators.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getByCommentsCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`.comments :text(&quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} comments&quot;)\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>返回 Playwright <a href="https://playwright.dev/docs/other-locators" target="_blank" rel="noreferrer">定位器字符串</a>来构造新的定位器。请注意，从此方法返回的字符串将用作于父定位器范围内（如果有的话）。</p><p>现在你可以直接在 <code>page</code> 对象或任何其他定位器上调用 <code>getByCommentsCount</code>：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByCommentsCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeVisible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;article&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByCommentsCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeVisible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>如果此方法返回字符串，返回值将被转换为定位器对象，因此你可以继续链式调用：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;article&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByCommentsCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;comments&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>此方法可以访问当前的定位器上下文（如果有的话，在 <code>page</code> 对象上调用时，则上下文指向 <code>page</code>），因此你可以在内部链式调用所有定位器方法：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Locator } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser/context&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { locators } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser/context&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locators.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getByCommentsCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Locator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;comment&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} comments\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>通过访问上下文，你还可以调用定位器的常规方法来定义自定义用户事件：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Locator } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser/context&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { locators, page } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser/context&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locators.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  clickAndFill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Locator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">text</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(text)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;textbox&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clickAndFill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>请参阅 <a href="/api/browser/locators.html#custom-locators"><code>locators.extend</code> API</a> 获取更多信息。</p><h2 id="explicit-resource-management-in-vi-spyon-and-vi-fn" tabindex="-1"><code>vi.spyOn</code> 和 <code>vi.fn</code> 中的显式资源管理 <a class="header-anchor" href="#explicit-resource-management-in-vi-spyon-and-vi-fn" aria-label="Permalink to “vi.spyOn 和 vi.fn 中的显式资源管理”">​</a></h2><p>在支持 <a href="https://github.com/tc39/proposal-explicit-resource-management" target="_blank" rel="noreferrer">显式资源管理</a> 的环境中，你可以使用 <code>using</code> 代替 <code>const</code>，以便在包含块退出时自动对任何模拟函数调用 <code>mockRestore</code>。这对于监听方法特别有用：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;calls console.log&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  using</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> spy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">spyOn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(console, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;log&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mockImplementation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {})</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(spy).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toHaveBeenCalled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// console.log 在此处还原</span></span></code></pre></div><h2 id="test-signal-api" tabindex="-1">测试 <code>signal</code> API <a class="header-anchor" href="#test-signal-api" aria-label="Permalink to “测试 signal API”">​</a></h2><p>Vitest 现在向测试主体提供一个 <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal" target="_blank" rel="noreferrer"><code>AbortSignal</code></a> 对象。你可以使用它来停止任何支持此 Web API 的资源。</p><p>当测试超时、其他测试失败且 <a href="/config/bail.html"><code>--bail</code> 标志</a> 设置为非零值，或者用户在终端中按下 Ctrl+C 时，信号会被中止。</p><p>例如，你可以在测试中断时停止 <code>fetch</code> 请求：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;stop request when test times out&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/heavy-resource&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { signal })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="coverage-v8-ast-aware-remapping" tabindex="-1">Coverage V8 AST 感知重映射 <a class="header-anchor" href="#coverage-v8-ast-aware-remapping" aria-label="Permalink to “Coverage V8 AST 感知重映射”">​</a></h2><p>Vitest 现在使用由 Vitest 维护者之一 <a href="https://github.com/AriPerkkio" target="_blank" rel="noreferrer">AriPerkkio</a> 开发的 <code>ast-v8-to-istanbul</code> 包。这使 v8 覆盖率报告与 istanbul 保持一致，但性能更好！通过将 <a href="/config/coverage.html#coverage-experimentalastawareremapping"><code>coverage.experimentalAstAwareRemapping</code></a> 设置为 <code>true</code> 来启用此功能。</p><p>我们计划在下一个主版本中将此作为默认重映射模式。旧的 <code>v8-to-istanbul</code> 将被完全移除。欢迎在 <a href="https://github.com/vitest-dev/vitest/issues/7928" target="_blank" rel="noreferrer">https://github.com/vitest-dev/vitest/issues/7928</a> 参与讨论。</p><h2 id="watchtriggerpatterns-option" tabindex="-1"><code>watchTriggerPatterns</code> 选项 <a class="header-anchor" href="#watchtriggerpatterns-option" aria-label="Permalink to “watchTriggerPatterns 选项”">​</a></h2><p>当你编辑文件时，Vitest 会智能地仅重新运行导入该文件的测试。遗憾的是，Vitest 的静态分析只支持静态和动态 <code>import</code> 语句。如果你通过文件读取或启动单独的进程，Vitest 将忽略相关文件的更改。</p><p>使用 <code>watchTriggerPatterns</code> 选项，你可以配置根据更改的文件重新运行哪些测试。例如，如果想要在更改模板时始终重新运行 <code>mailers</code> 测试，可以添加一个触发模式：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    watchTriggerPatterns: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pattern:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">src</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">templates</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">)</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">html</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">txt)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        testsToRun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`api/tests/mailers/\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">match</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.test.ts\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="the-new-multi-purpose-matchers-type" tabindex="-1">新的多用途 <code>Matchers</code> 类型 <a class="header-anchor" href="#the-new-multi-purpose-matchers-type" aria-label="Permalink to “新的多用途 Matchers 类型”">​</a></h2><p>Vitest 现在有一个 <code>Matchers</code> 类型，你可以扩展它来在一个地方为所有自定义匹配器添加类型支持。此类型影响以下所有用例：</p><ul><li><code>expect().to*</code></li><li><code>expect.to*</code></li><li><code>expect.extend({ to* })</code></li></ul><p>例如，要拥有一个类型安全的 <code>toBeFoo</code> 匹配器，你可以这样写：</p>`,53)),s("div",y,[i[103]||(i[103]=s("button",{title:"Copy Code",class:"copy"},null,-1)),i[104]||(i[104]=s("span",{class:"lang"},"ts",-1)),s("pre",F,[s("code",null,[s("span",c,[i[2]||(i[2]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import",-1)),i[3]||(i[3]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { ",-1)),s("span",u,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[0]||(i[0]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(alias) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," expect"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ExpectStatic")]),n(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," expect")])])])])],-1)])]),default:a(()=>[i[1]||(i[1]=s("span",null,"expect",-1))]),_:1})]),i[4]||(i[4]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," } ",-1)),i[5]||(i[5]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from",-1)),i[6]||(i[6]=s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'vitest'",-1))]),i[88]||(i[88]=n(`
`,-1)),i[89]||(i[89]=s("span",{class:"line"},null,-1)),i[90]||(i[90]=n(`
`,-1)),s("span",C,[i[11]||(i[11]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"interface",-1)),i[12]||(i[12]=s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ",-1)),s("span",m,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[7]||(i[7]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"interface"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CustomMatchers"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," unknown"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])],-1)])]),default:a(()=>[i[8]||(i[8]=s("span",null,"CustomMatchers",-1))]),_:1})]),i[13]||(i[13]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<",-1)),s("span",B,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[9]||(i[9]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(type parameter) "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," CustomMatchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," unknown"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">")])],-1)])]),default:a(()=>[i[10]||(i[10]=s("span",null,"R",-1))]),_:1})]),i[14]||(i[14]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =",-1)),i[15]||(i[15]=s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," unknown",-1)),i[16]||(i[16]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> {",-1))]),i[91]||(i[91]=n(`
`,-1)),s("span",f,[i[23]||(i[23]=s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  ",-1)),s("span",b,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[17]||(i[17]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) CustomMatchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," unknown"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".toBeFoo: ("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"arg"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," string"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," R")])],-1)])]),default:a(()=>[i[18]||(i[18]=s("span",null,"toBeFoo",-1))]),_:1})]),i[24]||(i[24]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":",-1)),i[25]||(i[25]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (",-1)),s("span",A,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[19]||(i[19]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(parameter) "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"arg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": string")])],-1)])]),default:a(()=>[i[20]||(i[20]=s("span",null,"arg",-1))]),_:1})]),i[26]||(i[26]=h('<span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> </span>',5)),s("span",w,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[21]||(i[21]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(type parameter) "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," CustomMatchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," unknown"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">")])],-1)])]),default:a(()=>[i[22]||(i[22]=s("span",null,"R",-1))]),_:1})])]),i[92]||(i[92]=h(`
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> module</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
`,7)),s("span",D,[i[35]||(i[35]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  interface",-1)),i[36]||(i[36]=s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ",-1)),s("span",v,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[27]||(i[27]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"interface"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Matchers"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"T"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," any"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])],-1)])]),default:a(()=>[i[28]||(i[28]=s("span",null,"Matchers",-1))]),_:1})]),i[37]||(i[37]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<",-1)),s("span",x,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[29]||(i[29]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(type parameter) "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"T"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Matchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"T"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," any"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">")])],-1)])]),default:a(()=>[i[30]||(i[30]=s("span",null,"T",-1))]),_:1})]),i[38]||(i[38]=h('<span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> </span>',5)),s("span",T,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[31]||(i[31]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"interface"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CustomMatchers"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"R"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," unknown"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])],-1)])]),default:a(()=>[i[32]||(i[32]=s("span",null,"CustomMatchers",-1))]),_:1})]),i[39]||(i[39]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<",-1)),s("span",P,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[33]||(i[33]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(type parameter) "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"T"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Matchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"T"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," any"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">")])],-1)])]),default:a(()=>[i[34]||(i[34]=s("span",null,"T",-1))]),_:1})]),i[40]||(i[40]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> {}",-1))]),i[93]||(i[93]=n(`
`,-1)),i[94]||(i[94]=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")],-1)),i[95]||(i[95]=n(`
`,-1)),i[96]||(i[96]=s("span",{class:"line"},null,-1)),i[97]||(i[97]=n(`
`,-1)),s("span",V,[s("span",S,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[41]||(i[41]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(alias) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," expect"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ExpectStatic")]),n(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," expect")])])])])],-1)])]),default:a(()=>[i[42]||(i[42]=s("span",null,"expect",-1))]),_:1})]),i[45]||(i[45]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".",-1)),s("span",I,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[43]||(i[43]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) ExpectStatic.extend: ("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"expects"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MatchersObject"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void")])],-1)])]),default:a(()=>[i[44]||(i[44]=s("span",null,"extend",-1))]),_:1})]),i[46]||(i[46]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({",-1))]),i[98]||(i[98]=n(`
`,-1)),s("span",R,[i[53]||(i[53]=s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  ",-1)),s("span",q,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[47]||(i[47]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) toBeFoo"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?:"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RawMatcherFn"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MatcherState, [arg: string]"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," undefined")])],-1)])]),default:a(()=>[i[48]||(i[48]=s("span",null,"toBeFoo",-1))]),_:1})]),i[54]||(i[54]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(",-1)),s("span",M,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[49]||(i[49]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(parameter) "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"actual"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": any")])],-1)])]),default:a(()=>[i[50]||(i[50]=s("span",null,"actual",-1))]),_:1})]),i[55]||(i[55]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ",-1)),s("span",j,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash-query",shown:!0},{popper:a(({})=>[...i[51]||(i[51]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("div",{class:"twoslash-popup-arrow"}),s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(parameter) "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"arg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": string")])],-1)])]),default:a(()=>[i[52]||(i[52]=s("span",null,"arg",-1))]),_:1})]),i[56]||(i[56]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {",-1))]),i[99]||(i[99]=h(`
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 具体实现...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
`,5)),s("span",N,[i[59]||(i[59]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ",-1)),s("span",O,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[57]||(i[57]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) SyncExpectationResult.pass: boolean")])],-1)])]),default:a(()=>[i[58]||(i[58]=s("span",null,"pass",-1))]),_:1})]),i[60]||(i[60]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ",-1)),i[61]||(i[61]=s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true",-1)),i[62]||(i[62]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",",-1))]),i[100]||(i[100]=n(`
`,-1)),s("span",$,[i[65]||(i[65]=s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      ",-1)),s("span",H,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[63]||(i[63]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) SyncExpectationResult.message: () "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," string")])],-1)])]),default:a(()=>[i[64]||(i[64]=s("span",null,"message",-1))]),_:1})]),i[66]||(i[66]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": () ",-1)),i[67]||(i[67]=s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>",-1)),i[68]||(i[68]=s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ''",-1)),i[69]||(i[69]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",",-1))]),i[101]||(i[101]=h(`
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
`,9)),s("span",L,[s("span",W,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[70]||(i[70]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(alias) "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"expect"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"string"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">(actual: string, message"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?:"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," string): "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Assertion"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"string"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> ("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," overload)")]),n(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," expect")])])])])],-1)])]),default:a(()=>[i[71]||(i[71]=s("span",null,"expect",-1))]),_:1})]),i[74]||(i[74]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(",-1)),i[75]||(i[75]=s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'foo'",-1)),i[76]||(i[76]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},").",-1)),s("span",U,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[72]||(i[72]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) CustomMatchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"string"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".toBeFoo: ("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"arg"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," string"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," string")])],-1)])]),default:a(()=>[i[73]||(i[73]=s("span",null,"toBeFoo",-1))]),_:1})]),i[77]||(i[77]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(",-1)),i[78]||(i[78]=s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'foo'",-1)),i[79]||(i[79]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")",-1))]),i[102]||(i[102]=n(`
`,-1)),s("span",z,[s("span",G,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[80]||(i[80]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(alias) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," expect"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ExpectStatic")]),n(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," expect")])])])])],-1)])]),default:a(()=>[i[81]||(i[81]=s("span",null,"expect",-1))]),_:1})]),i[84]||(i[84]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".",-1)),s("span",J,[l(t,{class:"twoslash-hover","popper-class":"shiki twoslash-floating vp-copy-ignore",theme:"twoslash"},{popper:a(({})=>[...i[82]||(i[82]=[s("span",{class:"twoslash-popup-container vp-copy-ignore"},[s("code",{class:"twoslash-popup-code"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(property) CustomMatchers"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"any"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".toBeFoo: ("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"arg"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," string"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," any")])],-1)])]),default:a(()=>[i[83]||(i[83]=s("span",null,"toBeFoo",-1))]),_:1})]),i[85]||(i[85]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(",-1)),i[86]||(i[86]=s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'foo'",-1)),i[87]||(i[87]=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")",-1))])])])]),i[106]||(i[106]=h(`<h2 id="sequence-grouporder" tabindex="-1"><code>sequence.groupOrder</code> <a class="header-anchor" href="#sequence-grouporder" aria-label="Permalink to “sequence.groupOrder”">​</a></h2><p>新的 <a href="/config/sequence.html#sequence-grouporder"><code>sequence.groupOrder</code></a> 选项控制在使用多个 <a href="/guide/projects.html">projects</a> 时项目测试执行的顺序。</p><ul><li>具有相同分组序号的测试项目将并行运行，各组按序号从低到高依次执行。</li><li>若未设置此选项，所有项目将默认并行执行。</li><li>当多个项目使用相同分组序号时，它们将同时执行。</li></ul><details class="details custom-block"><summary>示例</summary><p>考虑这个例子：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    projects: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;slow&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          sequence: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            groupOrder: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fast&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          sequence: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            groupOrder: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;flaky&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          sequence: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            groupOrder: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>这些项目中的测试将按以下顺序运行：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span> 0. slow  |</span></span>
<span class="line"><span>          |&gt; 并行执行</span></span>
<span class="line"><span> 0. fast  |</span></span>
<span class="line"><span></span></span>
<span class="line"><span> 1. flaky |&gt; 在 slow 和 fast 之后单独运行</span></span></code></pre></div></details><hr><p>完整的更改列表请查看 <a href="https://github.com/vitest-dev/vitest/releases/tag/v3.2.0" target="_blank" rel="noreferrer">Vitest 3.2 更新日志</a>。</p>`,6))])}const as=k(g,[["render",Z]]);export{is as __pageData,as as default};
