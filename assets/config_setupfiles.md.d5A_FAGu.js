import{_ as i,o as e,i as a,R as t}from"./chunks/framework.XDTXXE-5.js";const d=JSON.parse('{"title":"setupFiles | Config","description":"","frontmatter":{"title":"setupFiles | Config","outline":"deep"},"headers":[],"relativePath":"config/setupfiles.md","filePath":"config/setupfiles.md","lastUpdated":1771601921000}'),n={name:"config/setupfiles.md"};function l(p,s,h,o,r,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="setupfiles" tabindex="-1">setupFiles <a class="header-anchor" href="#setupfiles" aria-label="Permalink to “setupFiles”">​</a></h1><ul><li><strong>类型:</strong> <code>string | string[]</code></li></ul><p>Paths to setup files resolved relative to the <a href="/config/root.html"><code>root</code></a>. They will run before each <em>test file</em> in the same process. By default, all test files run in parallel, but you can configure it with <a href="/config/sequence.html#sequence-setupfiles"><code>sequence.setupFiles</code></a> option.</p><p>Vitest will ignore any exports from these files.</p><div class="warning custom-block"><p class="custom-block-title custom-block-title-default">WARNING</p><p>Note that setup files are executed in the same process as tests, unlike <a href="/config/globalsetup.html"><code>globalSetup</code></a> that runs once in the main thread before any test worker is created.</p></div><div class="info custom-block"><p class="custom-block-title custom-block-title-default">INFO</p><p>编辑设置文件将自动触发所有测试的重新运行。</p></div><p>If you have a heavy process running in the background, you can use <code>process.env.VITEST_POOL_ID</code> (integer-like string) inside to distinguish between workers and spread the workload.</p><div class="warning custom-block"><p class="custom-block-title custom-block-title-default">WARNING</p><p>If <a href="/config/isolate.html">isolation</a> is disabled, imported modules are cached, but the setup file itself is executed again before each test file, meaning that you are accessing the same global object before each test file. Make sure you are not doing the same thing more than necessary.</p><p>比如，你可能依赖于一个全局变量：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { config } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@some-testing-lib&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">globalThis.setupInitialized) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  config.plugins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [myCoolPlugin]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  computeHeavyThing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  globalThis.setupInitialized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// hooks reset before each test file</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cleanup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">globalThis.resetBeforeEachTest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span></code></pre></div></div>`,8)])])}const g=i(n,[["render",l]]);export{d as __pageData,g as default};
