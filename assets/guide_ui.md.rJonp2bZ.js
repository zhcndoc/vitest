import{_ as a,b as o,o as n,i as r,R as e,j as t,b2 as d,b3 as p,b4 as h,b5 as m,g as u,w as k,b6 as g,b7 as c,b8 as b,b9 as f,ba as _,bb as v,bc as T,bd as C,S as s,be as F,bf as E,bg as I,bh as y}from"./chunks/framework.XDTXXE-5.js";const D=JSON.parse('{"title":"Vitest UI | 指南","description":"","frontmatter":{"title":"Vitest UI | 指南"},"headers":[],"relativePath":"guide/ui.md","filePath":"guide/ui.md","lastUpdated":1771601921000}'),V={name:"guide/ui.md"};function x(w,i,S,A,P,N){const l=o("center");return n(),r("div",null,[i[1]||(i[1]=e('<h1 id="vitest-ui" tabindex="-1">UI 模式 <a class="header-anchor" href="#vitest-ui" aria-label="Permalink to “UI 模式”">​</a></h1><p>Vitest 由 Vite 提供能力，在运行测试时有一个开发服务器。这允许 Vitest 提供一个漂亮的 UI 界面来查看并与测试交互。Vitest 的 UI 界面是可选的，你可以通过以下安装：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @vitest/ui</span></span></code></pre></div><p>接下来，你可以通过传入 <code>--ui</code> 参数来启动测试的 UI 界面：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vitest</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --ui</span></span></code></pre></div><p>最后，你可以访问 Vitest UI 界面，通过 <a href="http://localhost:51204/__vitest__/"><code>http://localhost:51204/__vitest__/</code></a></p><div class="warning custom-block"><p class="custom-block-title custom-block-title-default">WARNING</p><p>UI 是交互式的，需要一个正在运行的 Vite 服务器，因此请确保在 <code>watch</code> 模式（默认模式）下运行 Vitest。或者，你可以通过在配置的 <code>reporters</code> 选项中指定 <code>html</code> 来生成一个与 Vitest UI 完全相同的静态 HTML 报告。</p></div>',7)),i[2]||(i[2]=t("img",{alt:"Vitest UI","img-light":"",src:d},null,-1)),i[3]||(i[3]=t("img",{alt:"Vitest UI","img-dark":"",src:p},null,-1)),i[4]||(i[4]=e(`<p>UI 也可以用作测试报告器。 在 Vitest 配置中使用 <code>&#39;html&#39;</code> 报告器生成 HTML 输出并预览测试结果：</p><div class="vp-code-block-title"><div class="vp-code-block-title-bar"><span class="vp-code-block-title-text" data-title="vitest.config.ts">vitest.config.ts</span></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reporters: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></div><p>你可以在 Vitest UI 中查看覆盖率报告：查看 <a href="/guide/coverage.html#vitest-ui">覆盖率 | UI 模式</a> 了解更多详情。</p><div class="warning custom-block"><p class="custom-block-title custom-block-title-default">WARNING</p><p>如果你仍想在终端中实时查看测试的运行情况，请不要忘记将 <code>default</code> 报告器添加到 <code>reporters</code> 选项：<code>[&#39;default&#39;, &#39;html&#39;]</code>。</p></div><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>要预览你的 HTML 报告，可以使用 <a href="https://vitejs.dev/guide/cli.html#vite-preview" target="_blank" rel="noreferrer">vite preview</a> 命令：</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preview</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --outDir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./html</span></span></code></pre></div><p>你可以使用 <a href="/config/outputfile.html"><code>outputFile</code></a> 配置选项配置输出。你需要在那里指定 <code>.html</code> 路径。例如，<code>./html/index.html</code> 是默认值。</p></div><h2 id="module-graph" tabindex="-1">模块图 <a class="header-anchor" href="#module-graph" aria-label="Permalink to “模块图”">​</a></h2><p>模块图选项卡显示所选测试文件的模块图。</p><div class="info custom-block"><p class="custom-block-title custom-block-title-default">INFO</p><p>所有示例图片均使用 <a href="https://github.com/zammad/zammad" target="_blank" rel="noreferrer">Zammad</a> 代码库作为演示。</p></div>`,8)),i[5]||(i[5]=t("img",{alt:"The module graph view","img-light":"",src:h},null,-1)),i[6]||(i[6]=t("img",{alt:"The module graph view","img-dark":"",src:m},null,-1)),i[7]||(i[7]=t("p",null,'如果模块数量超过 50 个时，模块图默认仅显示前两层结构以减少视觉干扰。你可以随时点击 "Show Full Graph" 图标来查看完整图表。',-1)),u(l,null,{default:k(()=>[...i[0]||(i[0]=[t("img",{alt:"The 'Show Full Graph' button located close to the legend","img-light":"",src:g},null,-1),t("img",{alt:"The 'Show Full Graph' button located close to the legend","img-dark":"",src:c},null,-1)])]),_:1}),i[8]||(i[8]=e('<div class="warning custom-block"><p class="custom-block-title custom-block-title-default">WARNING</p><p>注意：如果你的模块规模过大，节点位置可能需要一些时间才能稳定下来。</p></div><p>你可以随时点击 &quot;Reset&quot; 来恢复入口模块图。右键点击或按住 <kbd>Shift</kbd> 键，可展开查看与改节点相关的所有模块。</p><p>默认情况下，Vitest 会隐藏 <code>node_modules</code> 中的模块。通常，这些模块会被外部化。可以取消勾选 &quot;Hide node_modules&quot; 来显示它们。</p><h3 id="module-info" tabindex="-1">模块信息 <a class="header-anchor" href="#module-info" aria-label="Permalink to “模块信息”">​</a></h3><p>通过左键点击模块节点，你可以打开模块信息视图。</p>',5)),i[9]||(i[9]=t("img",{alt:"The module info view for an inlined module","img-light":"",src:b},null,-1)),i[10]||(i[10]=t("img",{alt:"The module info view for an inlined module","img-dark":"",src:f},null,-1)),i[11]||(i[11]=e('<p>此视图分为上下两部分。顶部显示完整的模块 ID 和一些关于模块的诊断信息。如果启用了 <a href="/config/experimental.html#experimental-fsmodulecache"><code>experimental.fsModuleCache</code></a>，将会显示 &quot;cached&quot; 或 &quot;not cached&quot; 的徽章。在右侧你可以看到时间诊断信息：</p><ul><li>自身时间：导入模块所花费的时间，不包括静态导入。</li><li>总耗时：导入模块所花费的时间，包括静态导入。请注意，这不包括当前模块的 <code>transform</code> 时间。</li><li>转换：转换模块所花费的时间。</li></ul><p>若你是通过点击导入项打开此视图，你还会在顶部看到一个 &quot;Back&quot; 按钮，点击可返回上一个模块。</p><p>底部显示内容取决于模块类型。对于外部模块，你仅能看到该文件的源代码。此时无法继续遍历模块依赖图，也无法查看静态导入的耗时情况。</p>',4)),i[12]||(i[12]=t("img",{alt:"The module info view for an external module","img-light":"",src:_},null,-1)),i[13]||(i[13]=t("img",{alt:"The module info view for an external module","img-dark":"",src:v},null,-1)),i[14]||(i[14]=e('<p>如果模块是内联的，你将看到另外三个窗口：</p><ul><li>源代码：模块未更改的源代码</li><li>转换后：Vitest 使用 Vite 的 <a href="https://cn.vite.dev/guide/api-environment-runtimes#modulerunner" target="_blank" rel="noreferrer">ModuleRunner</a> 执行的转换后代码</li><li>Source Map (v3)：源码映射关系</li></ul><p>&quot;Source&quot; 窗口中的所有静态导入显示当前模块评估它们的总耗时。如果导入已在模块图中被评估过，它将显示 <code>0ms</code>，因为此时已被缓存。</p><p>If the module took longer than the <a href="/config/experimental.html#experimental-importdurations-thresholds"><code>danger</code> threshold</a> (default: 500ms) to load, the time will be displayed in red. If the module took longer than the <a href="/config/experimental.html#experimental-importdurations-thresholds"><code>warn</code> threshold</a> (default: 100ms), the time will be displayed in orange.</p><p>你可以点击导入源代码跳转到该模块并进一步遍历图表（注意下面的 <code>./support/assertions/index.ts</code>）。</p>',5)),i[15]||(i[15]=t("img",{alt:"The module info view for an internal module","img-light":"",src:T},null,-1)),i[16]||(i[16]=t("img",{alt:"The module info view for an internal module","img-dark":"",src:C},null,-1)),i[17]||(i[17]=t("div",{class:"warning custom-block"},[t("p",{class:"custom-block-title custom-block-title-default"},"WARNING"),t("p",null,"请注意，仅类型导入在运行时不执行，不显示总耗时。它们也无法打开。")],-1)),i[18]||(i[18]=t("p",null,[s("如果另一个插件在转换期间注入模块导入，这些导入将在模块开始处以灰色显示（例如，通过 "),t("code",null,"import.meta.glob"),s(" 注入的模块）。它们也显示总耗时并且可以进一步遍历。")],-1)),i[19]||(i[19]=t("img",{alt:"The module info view for an internal module","img-light":"",src:F},null,-1)),i[20]||(i[20]=t("img",{alt:"The module info view for an internal module","img-dark":"",src:E},null,-1)),i[21]||(i[21]=e('<div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>如果你正在基于 Vitest 开发自定义集成，可以使用 <a href="/api/advanced/vitest.html#getsourcemodulediagnostic"><code>vitest.experimental_getSourceModuleDiagnostic</code></a> 来检索此信息。</p></div><h3 id="import-breakdown" tabindex="-1">导入耗时分析 <a class="header-anchor" href="#import-breakdown" aria-label="Permalink to “导入耗时分析”">​</a></h3><div class="tip custom-block"><p class="custom-block-title">功能反馈</p><p>请将关于此功能反馈提交至 <a href="https://github.com/vitest-dev/vitest/discussions/9224" target="_blank" rel="noreferrer">GitHub Discussion</a>。</p></div><p>模块依赖图标签还提供了导入耗时分析功能，默认显示加载耗时最长的前 10 个模块列表（按总耗时排序）。</p>',4)),i[22]||(i[22]=t("img",{alt:"Import breakdown with a list of top 10 modules that take the longest time to load","img-light":"",src:I},null,-1)),i[23]||(i[23]=t("img",{alt:"Import breakdown with a list of top 10 modules that take the longest time to load","img-dark":"",src:y},null,-1)),i[24]||(i[24]=e('<p>你可以点击模块查看模块信息。如果模块是外部的，它将显示黄色（与模块图中的颜色相同）。</p><p>分析列表包含自用耗时、总耗时以及相对于加载整个测试文件所花费时间的百分比。</p><p>当存在至少一个文件加载时间超过 <a href="/config/experimental.html#experimental-importdurations-thresholds"><code>danger</code> 阈值</a>（默认值：500 毫秒）时，“显示导入耗时分析” 图标将呈现红色；如果存在至少一个文件加载时间超过 <a href="/config/experimental.html#experimental-importdurations-thresholds"><code>warn</code>阈值</a>（默认值：100 毫秒），则图标显示为橙色。</p><p>你可以使用 <a href="/config/experimental.html#experimental-importdurationslimit"><code>experimental.importDurations.limit</code></a> 配置项控制显示的导入项数量上限。</p>',4))])}const U=a(V,[["render",x]]);export{D as __pageData,U as default};
