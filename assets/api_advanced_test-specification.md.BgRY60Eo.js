import{_ as h,b as p,o as k,i as d,R as l,j as a,S as i,g as e,w as n}from"./chunks/framework.XDTXXE-5.js";const C=JSON.parse('{"title":"TestSpecification","description":"","frontmatter":{},"headers":[],"relativePath":"api/advanced/test-specification.md","filePath":"api/advanced/test-specification.md","lastUpdated":1771601921000}'),r={name:"api/advanced/test-specification.md"},o={id:"testnamepattern",tabindex:"-1"},c={id:"testids",tabindex:"-1"},E={id:"testtagsfilter",tabindex:"-1"};function g(y,s,F,b,u,f){const t=p("Version");return k(),d("div",null,[s[12]||(s[12]=l(`<h1 id="testspecification" tabindex="-1">TestSpecification <a class="header-anchor" href="#testspecification" aria-label="Permalink to “TestSpecification”">​</a></h1><p><code>TestSpecification</code> 类描述了要作为测试运行的模块及其参数。</p><p>你只能通过在测试项目上调用 <a href="/api/advanced/test-project.html#createspecification"><code>createSpecification</code></a> 方法来创建规范：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> specification</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> project.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createSpecification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./example.test.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    testLines: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    testNamePattern:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">hello world</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    testIds: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;1223128da3_0_0_0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;1223128da3_0_0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    testTagsFilter: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;frontend and backend&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可选的测试过滤器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><code>createSpecification</code> 期望一个已解析的模块 ID。它不会自动解析文件或检查文件是否存在于文件系统中。</p><h2 id="taskid" tabindex="-1">taskId <a class="header-anchor" href="#taskid" aria-label="Permalink to “taskId”">​</a></h2><p><a href="/api/advanced/test-suite.html#id">测试模块</a> 的标识符。</p><h2 id="project" tabindex="-1">project <a class="header-anchor" href="#project" aria-label="Permalink to “project”">​</a></h2><p>这引用了测试模块所属的 <a href="/api/advanced/test-project.html"><code>TestProject</code></a>。</p><h2 id="moduleid" tabindex="-1">moduleId <a class="header-anchor" href="#moduleid" aria-label="Permalink to “moduleId”">​</a></h2><p>Vite 模块图中的模块 ID。通常，它是一个使用 POSIX 分隔符的绝对文件路径：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C:/Users/Documents/project/example.test.ts&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // ✅</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/Users/mac/project/example.test.ts&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // ✅</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Documents</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">example.test.ts&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // ❌</span></span></code></pre></div><h2 id="testmodule" tabindex="-1">testModule <a class="header-anchor" href="#testmodule" aria-label="Permalink to “testModule”">​</a></h2><p>与规范相关联的 <a href="/api/advanced/test-module.html"><code>TestModule</code></a> 实例。如果测试还未加入队列，则将是 <code>undefined</code>。</p><h2 id="pool" tabindex="-1">pool <a class="header-anchor" href="#pool" aria-label="Permalink to “pool”">​</a></h2><p>测试模块将运行的 <a href="/config/pool.html"><code>pool</code></a>。</p><div class="danger custom-block"><p class="custom-block-title custom-block-title-default">DANGER</p><p>It&#39;s possible to have multiple pools in a single test project with <a href="/config/typecheck.html#typecheck-enabled"><code>typecheck.enabled</code></a>. This means it&#39;s possible to have several specifications with the same <code>moduleId</code> but different <code>pool</code>. In later versions, the project will only support a single pool.</p></div><h2 id="testlines" tabindex="-1">testLines <a class="header-anchor" href="#testlines" aria-label="Permalink to “testLines”">​</a></h2><p>这是源代码中定义测试文件的行号数组。此字段仅在 <code>createSpecification</code> 方法接收数组时定义。</p><p>请注意，如果这些行中的至少一行没有测试，整个测试套件将会失败。以下是一个正确的 <code>testLines</code> 配置示例：</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-59" id="tab-60" checked><label data-title="script.js" for="tab-60">script.js</label><input type="radio" name="group-59" id="tab-61"><label data-title="example.test.js" for="tab-61">example.test.js</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> specification</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> project.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createSpecification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./example.test.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark has-highlighted" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { test, describe } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;verification works&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line highlighted error"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a group of tests&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nested test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">skip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;skipped test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div></div>`,21)),a("h2",o,[s[1]||(s[1]=i("testNamePattern ",-1)),e(t,null,{default:n(()=>[...s[0]||(s[0]=[i("4.1.0",-1)])]),_:1}),s[2]||(s[2]=i()),s[3]||(s[3]=a("a",{class:"header-anchor",href:"#testnamepattern","aria-label":"Permalink to “testNamePattern 4.1.0”"},"​",-1))]),s[13]||(s[13]=a("p",null,[i("A regexp that matches the name of the test in this module. This value will override the global "),a("a",{href:"/config/testnamepattern.html"},[a("code",null,"testNamePattern")]),i(" option if it's set.")],-1)),a("h2",c,[s[5]||(s[5]=i("testIds ",-1)),e(t,null,{default:n(()=>[...s[4]||(s[4]=[i("4.1.0",-1)])]),_:1}),s[6]||(s[6]=i()),s[7]||(s[7]=a("a",{class:"header-anchor",href:"#testids","aria-label":"Permalink to “testIds 4.1.0”"},"​",-1))]),s[14]||(s[14]=a("p",null,"The ids of tasks inside of this specification to run.",-1)),a("h2",E,[s[9]||(s[9]=i("testTagsFilter ",-1)),e(t,null,{default:n(()=>[...s[8]||(s[8]=[i("4.1.0",-1)])]),_:1}),s[10]||(s[10]=i()),s[11]||(s[11]=a("a",{class:"header-anchor",href:"#testtagsfilter","aria-label":"Permalink to “testTagsFilter 4.1.0”"},"​",-1))]),s[15]||(s[15]=l('<p>The <a href="/guide/test-tags.html#syntax">tags filter</a> that a test must pass in order to be included in the run. Multiple filters are treated as <code>AND</code>.</p><h2 id="tojson" tabindex="-1">toJSON <a class="header-anchor" href="#tojson" aria-label="Permalink to “toJSON”">​</a></h2><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toJSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SerializedTestSpecification</span></span></code></pre></div><p><code>toJSON</code> 生成一个 JSON 友好的对象，可以被 <a href="/guide/browser/">浏览器模式</a> 或 <a href="/guide/ui.html">UI 模式</a> 消费。</p>',4))])}const B=h(r,[["render",g]]);export{C as __pageData,B as default};
