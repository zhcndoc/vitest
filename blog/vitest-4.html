<!DOCTYPE html>
<html lang="zh" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vitest 4.0 is out! | Vitest 中文文档</title>
    <meta name="description" content="由 Vite 驱动的下一代测试框架">
    <meta name="generator" content="VitePress v2.0.0-alpha.16">
    <link rel="preload stylesheet" href="/assets/style.CA0zvmhE.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DRxHkRZW.js"></script>
    <link rel="modulepreload" href="/assets/chunks/theme.BuCIPd6e.js">
    <link rel="modulepreload" href="/assets/chunks/framework.XDTXXE-5.js">
    <link rel="modulepreload" href="/assets/blog_vitest-4.md.DGccDxcE.lean.js">
    <meta name="theme-color" content="#22FF84">
    <link rel="icon" href="/favicon.ico" sizes="48x48">
    <link rel="icon" href="/logo-without-border.svg" type="image/svg+xml">
    <meta name="author" content="Vladimir, Anthony Fu, Ari Perkkiö, Hiroshi Ogawa, Patak, Joaquín Sánchez and Vitest 中文文档 contributors">
    <meta name="keywords" content="vitest, vite, test, coverage, snapshot, react, vue, preact, svelte, solid, lit, marko, ruby, cypress, puppeteer, jsdom, happy-dom, test-runner, jest, typescript, esm, tinyspy, node">
    <meta property="og:title" content="Vitest 4.0 发布了！">
    <meta property="og:description" content="Vitest 4.0 Release Announcement">
    <meta property="og:url" content="https://vitest.dev/blog/vitest-4">
    <meta property="og:image" content="https://vitest.dev/og-vitest-4.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://fonts.googleapis.com/css2?family=Readex+Pro:wght@200;400;600&amp;display=swap">
    <noscript><link rel="stylesheet" crossorigin="anonymous" href="https://fonts.googleapis.com/css2?family=Readex+Pro:wght@200;400;600&display=swap" /></noscript>
    <link rel="me" href="https://m.webtoo.ls/@vitest">
    <link rel="mask-icon" href="/logo.svg" color="#ffffff">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
    <script async src="https://www.zhcndoc.com/js/common.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta property="og:type" content="website">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="prefetch" href="/logo.svg" as="image">
    <link rel="manifest" href="/manifest.webmanifest">
  </head>
  <body>
    <div id="app"><div class="docs-layout" data-variant="vitest" data-v-36ea7de7><div class="Layout" data-v-36ea7de7 data-v-e9f02063><!----><!--[--><!--]--><!--[--><span tabindex="-1" data-v-e499cabe></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-e499cabe>Skip to content</a><!--]--><!----><div class="relative w-full z-50 lg:fixed lg:left-0 lg:right-0 lg:top-[var(--vp-banner-height,0)]" data-v-e9f02063 data-v-a3ac6ce2><header class="wrapper px-6 py-5 flex items-center justify-between relative bg-white dark:bg-primary border-b border-stroke dark:border-nickel" data-v-a3ac6ce2><div class="flex gap-10 self-stretch" data-v-a3ac6ce2><a href="/" class="flex flex-col items-start justify-center -mx-2 px-2" data-v-a3ac6ce2><!--[--><!--]--><img class="h-4 block dark:hidden" src="/assets/vitest-dark.BVx57gsK.svg" alt="Vitest" data-v-a3ac6ce2><img class="h-4 hidden dark:block" src="/assets/vitest-light.fqspNQ2H.svg" alt="Vitest" data-v-a3ac6ce2><!--[--><!--]--></a><div class="hidden lg:flex items-center gap-4" data-v-a3ac6ce2><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu" data-v-a3ac6ce2 data-v-b5673093><span id="main-nav-aria-label" class="visually-hidden" data-v-b5673093> Main Navigation </span><!--[--><!--[--><a class="VPLink link flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-85 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" href="/guide/" tabindex="0" data-v-b5673093 data-v-e0883a60><!--[--><span data-v-e0883a60>指南</span><!--]--></a><!--]--><!--[--><a class="VPLink link flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-85 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" href="/api/test.html" tabindex="0" data-v-b5673093 data-v-e0883a60><!--[--><span data-v-e0883a60>API</span><!--]--></a><!--]--><!--[--><a class="VPLink link flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-85 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" href="/config/" tabindex="0" data-v-b5673093 data-v-e0883a60><!--[--><span data-v-e0883a60>配置</span><!--]--></a><!--]--><!--[--><a class="VPLink link flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-85 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" href="/blog.html" tabindex="0" data-v-b5673093 data-v-e0883a60><!--[--><span data-v-e0883a60>博客</span><!--]--></a><!--]--><!--[--><div class="VPFlyout relative flex items-center VPNavBarMenuGroup" data-v-b5673093 data-v-264a30c0><button type="button" class="flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-70 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" aria-haspopup="true" aria-expanded="false" data-v-264a30c0><span class="flex items-center gap-1 leading-normal overflow-hidden" data-v-264a30c0><!----><span class="overflow-hidden text-ellipsis" data-v-264a30c0>v4.0.17</span><span class="vpi-chevron-down text-sm shrink-0" data-v-264a30c0></span></span></button><div class="menu" data-v-264a30c0><div class="VPMenu rounded-sm p-3 min-w-32 border border-stroke dark:border-nickel bg-white dark:bg-primary shadow-lg max-h-[calc(100vh-var(--vp-nav-height))] overflow-y-auto" data-v-264a30c0 data-v-28d667b0><div class="items" data-v-28d667b0><!--[--><!--[--><div class="VPMenuGroup" data-v-28d667b0 data-v-50d29457><!----><!--[--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://github.com/vitest-dev/vitest/releases/tag/v4.0.17" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>v4.0.17</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://github.com/vitest-dev/vitest/releases" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>更新日志</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://github.com/vitest-dev/vitest/blob/main/CONTRIBUTING.md" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>贡献指南</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="/team.html" data-v-25a67434><!--[--><span data-v-25a67434>团队</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-28d667b0 data-v-50d29457><!----><!--[--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://main.vitest.dev/" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>未发布</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://v3.cn.vitest.dev/" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>v3.x</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://v2.vitest.dev/" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>v2.x</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://v1.vitest.dev/" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>v1.x</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-50d29457 data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://v0.vitest.dev/" target="_blank" rel="noreferrer" data-v-25a67434><!--[--><span data-v-25a67434>v0.x</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav></div></div><div class="flex items-center gap-2 lg:gap-4" data-v-a3ac6ce2><div class="hidden lg:flex items-center" data-v-a3ac6ce2><div class="VPNavBarSearch" data-v-a3ac6ce2><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button VPSearchButton"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div></div><div class="hidden lg:flex xl:hidden items-center gap-4" data-v-a3ac6ce2><div class="VPFlyout relative flex items-center VPNavBarExtra" data-v-a3ac6ce2 data-v-dc11a1ea data-v-264a30c0><button type="button" class="flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-70 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-264a30c0><span class="vpi-more-horizontal text-xl" data-v-264a30c0></span></button><div class="menu" data-v-264a30c0><div class="VPMenu rounded-sm p-3 min-w-32 border border-stroke dark:border-nickel bg-white dark:bg-primary shadow-lg max-h-[calc(100vh-var(--vp-nav-height))] overflow-y-auto" data-v-264a30c0 data-v-28d667b0><!----><!--[--><!--[--><div class="group translations" data-v-dc11a1ea><p class="trans-title" data-v-dc11a1ea>简体中文</p><!--[--><div class="VPMenuLink" data-v-dc11a1ea data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://vitest.dev/blog/vitest-4.html" target="_blank" rel="noreferrer" lang="en-US" data-v-25a67434><!--[--><span data-v-25a67434>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-dc11a1ea><div class="item appearance" data-v-dc11a1ea><p class="label" data-v-dc11a1ea>Appearance</p><div class="appearance-action" data-v-dc11a1ea><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-dc11a1ea data-v-ec1ef58b data-v-930f49f3><span class="check" data-v-930f49f3><span class="icon" data-v-930f49f3><!--[--><span class="vpi-sun sun" data-v-ec1ef58b></span><span class="vpi-moon moon" data-v-ec1ef58b></span><!--]--></span></span></button></div></div></div><div class="group" data-v-dc11a1ea><div class="item social-links" data-v-dc11a1ea><div class="VPSocialLinks social-links-list" data-v-dc11a1ea data-v-5f1731a9><!--[--><a class="VPSocialLink no-icon" href="https://bsky.app/profile/vitest.dev" aria-label="bluesky" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-bluesky"></span></a><a class="VPSocialLink no-icon" href="https://elk.zone/m.webtoo.ls/@vitest" aria-label="mastodon" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-mastodon"></span></a><a class="VPSocialLink no-icon" href="https://chat.vitest.dev" aria-label="discord" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-discord"></span></a><a class="VPSocialLink no-icon" href="https://github.com/vitest-dev/vitest" aria-label="github" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div></div><div class="hidden xl:flex items-center gap-4" data-v-a3ac6ce2><div class="VPNavBarAppearance" data-v-a3ac6ce2 data-v-7f09cf70><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-7f09cf70 data-v-ec1ef58b data-v-930f49f3><span class="check" data-v-930f49f3><span class="icon" data-v-930f49f3><!--[--><span class="vpi-sun sun" data-v-ec1ef58b></span><span class="vpi-moon moon" data-v-ec1ef58b></span><!--]--></span></span></button></div><div class="VPFlyout relative flex items-center VPNavBarTranslations" data-v-a3ac6ce2 data-v-a8dbb97e data-v-264a30c0><button type="button" class="flex items-center px-3 py-2 text-base font-heading text-primary dark:text-white hover:opacity-70 transition-opacity whitespace-nowrap overflow-hidden text-ellipsis" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-264a30c0><span class="flex items-center gap-1 leading-normal overflow-hidden" data-v-264a30c0><span class="vpi-languages shrink-0" data-v-264a30c0></span><!----><span class="vpi-chevron-down text-sm shrink-0" data-v-264a30c0></span></span></button><div class="menu" data-v-264a30c0><div class="VPMenu rounded-sm p-3 min-w-32 border border-stroke dark:border-nickel bg-white dark:bg-primary shadow-lg max-h-[calc(100vh-var(--vp-nav-height))] overflow-y-auto" data-v-264a30c0 data-v-28d667b0><!----><!--[--><!--[--><div class="items" data-v-a8dbb97e><p class="title" data-v-a8dbb97e>简体中文</p><!--[--><div class="VPMenuLink" data-v-a8dbb97e data-v-25a67434><a class="VPLink link vp-external-link-icon flex items-center justify-between rounded-md px-3 py-2 text-sm font-heading text-primary dark:text-white text-left whitespace-nowrap hover:opacity-70 transition-opacity" href="https://vitest.dev/blog/vitest-4.html" target="_blank" rel="noreferrer" lang="en-US" data-v-25a67434><!--[--><span data-v-25a67434>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPSocialLinks VPNavBarSocialLinks" data-v-a3ac6ce2 data-v-4082682c data-v-5f1731a9><!--[--><a class="VPSocialLink no-icon" href="https://bsky.app/profile/vitest.dev" aria-label="bluesky" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-bluesky"></span></a><a class="VPSocialLink no-icon" href="https://elk.zone/m.webtoo.ls/@vitest" aria-label="mastodon" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-mastodon"></span></a><a class="VPSocialLink no-icon" href="https://chat.vitest.dev" aria-label="discord" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-discord"></span></a><a class="VPSocialLink no-icon" href="https://github.com/vitest-dev/vitest" aria-label="github" target="_blank" rel="me noopener" data-v-5f1731a9 data-v-e200c437><span class="vpi-social-github"></span></a><!--]--></div></div><button aria-label="Search" class="lg:hidden p-2 text-primary dark:text-white hover:opacity-70 transition-opacity cursor-pointer" type="button" data-v-a3ac6ce2><svg class="size-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a3ac6ce2><path d="M17.5 17.5L13.875 13.875M15.8333 9.16667C15.8333 12.8486 12.8486 15.8333 9.16667 15.8333C5.48477 15.8333 2.5 12.8486 2.5 9.16667C2.5 5.48477 5.48477 2.5 9.16667 2.5C12.8486 2.5 15.8333 5.48477 15.8333 9.16667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-a3ac6ce2></path></svg></button><button aria-expanded="false" aria-controls="mobile-menu" aria-label="Toggle navigation menu" class="lg:hidden p-2 -mr-2 text-primary dark:text-white hover:opacity-70 transition-opacity cursor-pointer" type="button" data-v-a3ac6ce2><svg class="size-6 block dark:hidden" viewBox="0 0 18 8" xmlns="http://www.w3.org/2000/svg" data-v-a3ac6ce2><path d="M0 0.75H18" stroke="#08060D" stroke-width="1.5" data-v-a3ac6ce2></path><path d="M0 6.75H18" stroke="#08060D" stroke-width="1.5" data-v-a3ac6ce2></path></svg><svg class="size-6 hidden dark:block" viewBox="0 0 18 8" xmlns="http://www.w3.org/2000/svg" data-v-a3ac6ce2><path d="M0 0.75H18" stroke="#FFFFFF" stroke-width="1.5" data-v-a3ac6ce2></path><path d="M0 6.75H18" stroke="#FFFFFF" stroke-width="1.5" data-v-a3ac6ce2></path></svg></button></div></header><div class="wrapper relative h-0 tick-left tick-right" data-v-a3ac6ce2></div><!----></div><div class="flex flex-col min-h-screen" data-v-e9f02063><div class="content-wrapper flex-1" data-v-e9f02063><div class="VPLocalNav empty fixed" data-v-e9f02063 data-v-7ea4c487><div class="container" data-v-7ea4c487><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-7ea4c487 data-v-0513bb9f><button data-v-0513bb9f>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-e9f02063 data-v-edec4973><div class="VPDoc has-aside" data-v-edec4973 data-v-f57fb085><!--[--><!--]--><div class="container" data-v-f57fb085><div class="aside" data-v-f57fb085><div class="aside-curtain" data-v-f57fb085></div><div class="aside-container" data-v-f57fb085><div class="aside-content" data-v-f57fb085><div class="VPDocAside" data-v-f57fb085 data-v-e473254d><!--[--><!--]--><!--[--><!--[--><!--[--><!--[--><!--[--><div class="wwads-cn wwads-vertical mt-0! mb-4" data-id="354"></div><!--]--><!--]--><!--]--><!--]--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-e473254d data-v-9b992b5c><div class="content" data-v-9b992b5c><div class="outline-marker" data-v-9b992b5c></div><div aria-level="2" class="outline-title flex items-center gap-2 uppercase text-xs text-grey tracking-wide font-medium" id="doc-outline-aria-label" role="heading" data-v-9b992b5c><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-9b992b5c><path d="M7.3335 3.66669H14.0002" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" data-v-9b992b5c></path><path d="M3.6 11.2618C4.31111 11.738 4.66667 11.9762 4.66667 12.3334C4.66667 12.6906 4.31111 12.9287 3.6 13.405C2.88889 13.8812 2.53333 14.1193 2.26667 13.9408C2 13.7622 2 13.2859 2 12.3334C2 11.3808 2 10.9046 2.26667 10.726C2.53333 10.5474 2.88889 10.7855 3.6 11.2618Z" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" data-v-9b992b5c></path><path d="M3.6 2.59509C4.31111 3.07135 4.66667 3.30947 4.66667 3.66667C4.66667 4.02386 4.31111 4.26199 3.6 4.73825C2.88889 5.21451 2.53333 5.45263 2.26667 5.27403C2 5.09544 2 4.61918 2 3.66667C2 2.71415 2 2.23789 2.26667 2.0593C2.53333 1.8807 2.88889 2.11883 3.6 2.59509Z" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" data-v-9b992b5c></path><path d="M7.3335 8H14.0002" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" data-v-9b992b5c></path><path d="M7.3335 12.3333H14.0002" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" data-v-9b992b5c></path></svg> On this page</div><ul class="VPDocOutlineItem root" data-v-9b992b5c data-v-961fa2bd><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-e473254d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-f57fb085><div class="content-container" data-v-f57fb085><!--[--><!--]--><main class="main" data-v-f57fb085><div style="position:relative;" class="vp-doc _blog_vitest-4" data-v-f57fb085><div><h1 id="vitest-4-0-is-out" tabindex="-1">Vitest 4.0 is out! <a class="header-anchor" href="#vitest-4-0-is-out" aria-label="Permalink to “Vitest 4.0 is out!”">​</a></h1><p><em>October 22, 2025</em></p><p><img src="/og-vitest-4.jpg" alt="Vitest 4 Announcement Cover Image"></p><h2 id="the-next-vitest-major-is-here" tabindex="-1">The next Vitest major is here <a class="header-anchor" href="#the-next-vitest-major-is-here" aria-label="Permalink to “The next Vitest major is here”">​</a></h2><p>Today, we are thrilled to announce Vitest 4!</p><p>Quick links:</p><ul><li><a href="/">Docs</a></li><li>Translations: <a href="https://cn.vitest.dev/" target="_blank" rel="noreferrer">简体中文</a></li><li><a href="/guide/migration.html#vitest-4">Migration Guide</a></li><li><a href="https://github.com/vitest-dev/vitest/releases/tag/v4.0.0" target="_blank" rel="noreferrer">GitHub Changelog</a></li></ul><p>If you&#39;ve not used Vitest before, we suggest reading the <a href="/guide/">Getting Started</a> and <a href="/guide/features.html">Features</a> guides first.</p><p>We extend our gratitude to the over <a href="https://github.com/vitest-dev/vitest/graphs/contributors" target="_blank" rel="noreferrer">640 contributors to Vitest Core</a> and to the maintainers and contributors of Vitest integrations, tools, and translations who have helped us develop this new major release. We encourage you to get involved and help us improve Vitest for the entire ecosystem. Learn more at our <a href="https://github.com/vitest-dev/vitest/blob/main/CONTRIBUTING.md" target="_blank" rel="noreferrer">Contributing Guide</a>.</p><p>To get started, we suggest helping <a href="https://github.com/vitest-dev/vitest/issues" target="_blank" rel="noreferrer">triage issues</a>, <a href="https://github.com/vitest-dev/vitest/pulls" target="_blank" rel="noreferrer">review PRs</a>, send failing tests PRs based on open issues, and support others in <a href="https://github.com/vitest-dev/vitest/discussions" target="_blank" rel="noreferrer">Discussions</a> and Vitest Land&#39;s <a href="https://discord.com/channels/917386801235247114/1057959614160851024" target="_blank" rel="noreferrer">help forum</a>. If you&#39;d like to talk to us, join our <a href="http://chat.vitest.dev/" target="_blank" rel="noreferrer">Discord community</a> and say hi on the <a href="https://discord.com/channels/917386801235247114/1057959614160851024" target="_blank" rel="noreferrer">#contributing channel</a>.</p><p>For the latest news about the Vitest ecosystem and Vitest core, follow us on <a href="https://bsky.app/profile/vitest.dev" target="_blank" rel="noreferrer">Bluesky</a> or <a href="https://webtoo.ls/@vitest" target="_blank" rel="noreferrer">Mastodon</a>.</p><p>To stay updated, keep an eye on the <a href="https://voidzero.dev/blog" target="_blank" rel="noreferrer">VoidZero blog</a> and subscribe to the <a href="https://voidzero.dev/newsletter" target="_blank" rel="noreferrer">newsletter</a>.</p><h2 id="browser-mode-is-stable" tabindex="-1">Browser Mode is Stable <a class="header-anchor" href="#browser-mode-is-stable" aria-label="Permalink to “Browser Mode is Stable”">​</a></h2><p>With this release we are removing the <code>experimental</code> tag from <a href="/guide/browser/">Browser Mode</a>. To make it possible, we had to introduce some changes to the public API.</p><p>To define a provider, you now need to install a separate package: <a href="https://www.npmjs.com/package/@vitest/browser-playwright" target="_blank" rel="noreferrer"><code>@vitest/browser-playwright</code></a>, <a href="https://www.npmjs.com/package/@vitest/browser-webdriverio" target="_blank" rel="noreferrer"><code>@vitest/browser-webdriverio</code></a>, or <a href="https://www.npmjs.com/package/@vitest/browser-preview" target="_blank" rel="noreferrer"><code>@vitest/browser-preview</code></a>. This makes it simpler to work with custom options and doesn&#39;t require adding <code>/// &lt;reference</code> comments anymore.</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-64" id="tab-65" checked><label data-title="playwright" for="tab-65">playwright</label><input type="radio" name="group-64" id="tab-66"><label data-title="webdriverio" for="tab-66">webdriverio</label><input type="radio" name="group-64" id="tab-67"><label data-title="preview" for="tab-67">preview</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark has-diff" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/config&#39;</span></span>
<span class="line diff add"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { playwright } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser-playwright&#39;</span></span>
<span class="line diff remove"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/// &lt;reference path=&quot;@vitest/browser/providers/playwright&quot; /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser: {</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;playwright&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">playwright</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        launchOptions: { </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          slowMo: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }), </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      instances: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          browser: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;chromium&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          launch: { </span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            slowMo: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark has-diff" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/config&#39;</span></span>
<span class="line diff add"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { webdriverio } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser-webdriverio&#39;</span></span>
<span class="line diff remove"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/// &lt;reference path=&quot;@vitest/browser/providers/webdriverio&quot; /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser: {</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;webdriverio&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">webdriverio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        capabilities: { </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          browserVersion: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;82&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      instances: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          browser: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;chrome&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          capabilities: { </span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            browserVersion: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;82&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark has-diff" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/config&#39;</span></span>
<span class="line diff add"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { preview } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser-preview&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser: {</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;preview&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      instances: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        { browser: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;chrome&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></div></div><p>The context is no longer imported from <code>@vitest/browser/context</code> (but it will keep working until the next major version for better compatibility with tools that did not update yet), now just import from <code>vitest/browser</code>:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark has-diff" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line diff remove"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { page } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vitest/browser/context&#39;</span></span>
<span class="line diff add"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { page } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/browser&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;button&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>With these changes, the <code>@vitest/browser</code> package can be removed from your dependencies. It is now included in every provider package automatically.</p><h2 id="visual-regression-testing" tabindex="-1">Visual Regression Testing <a class="header-anchor" href="#visual-regression-testing" aria-label="Permalink to “Visual Regression Testing”">​</a></h2><p>Vitest 4 adds support for <a href="/guide/browser/visual-regression-testing.html">Visual Regression testing</a> in Browser Mode. We will continue to iterate on this feature to improve the experience.</p><p>Visual regression testing in Vitest can be done through the <a href="/api/browser/assertions.html#tomatchscreenshot"><code>toMatchScreenshot</code> assertion</a>:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { expect, test } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { page } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/browser&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hero section looks correct&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...the rest of the test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // capture and compare screenshot</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByTestId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hero&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toMatchScreenshot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hero-section&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Vitest captures screenshots of your UI components and pages, then compares them against reference images to detect unintended visual changes.</p><p>Alongside this feature, Vitest also introduces a <code>toBeInViewport</code> matcher. It allows you to check if an element is currently in viewport with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" target="_blank" rel="noreferrer">IntersectionObserver API</a>.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// A specific element is in viewport.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Welcome&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeInViewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 50% of a specific element should be in viewport</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;To&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeInViewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ ratio: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span></code></pre></div><h2 id="playwright-traces-support" tabindex="-1">Playwright Traces Support <a class="header-anchor" href="#playwright-traces-support" aria-label="Permalink to “Playwright Traces Support”">​</a></h2><p>Vitest 4 supports generating <a href="/guide/browser/trace-view.html">Playwright Traces</a>. To enable tracing, you need to set the <a href="/config/browser/trace.html"><code>trace</code></a> option in the <code>test.browser</code> configuration or pass down <code>--browser.trace=on</code> option (<code>off</code>, <code>on-first-retry</code>, <code>on-all-retries</code>, <code>retain-on-failure</code> are also available).</p><p><img src="/traces.png" alt="Playwright Traces interface"></p><p>The traces are available in reporters as <a href="/guide/test-annotations.html">annotations</a>. For example, in the HTML reporter, you can find the link to the trace file in the test details. To open the trace file, you can use the <a href="https://playwright.dev/docs/trace-viewer" target="_blank" rel="noreferrer">Playwright Trace Viewer</a>.</p><h2 id="locator-improvements" tabindex="-1">Locator Improvements <a class="header-anchor" href="#locator-improvements" aria-label="Permalink to “Locator Improvements”">​</a></h2><p>The <code>frameLocator</code> method returns a <code>FrameLocator</code> instance that can be used to find elements inside the iframe. Vitest now supports a new <a href="/api/browser/context.html#framelocator"><code>page.frameLocator</code></a> API (only with <code>playwright</code> provider).</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> frame</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">frameLocator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByTestId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iframe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> frame.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> frame.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ Not available</span></span></code></pre></div><p>Every locator now exposes a <code>length</code> property, allowing them to be used with <code>toHaveLength</code> matcher automatically:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Item&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toHaveLength</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="improved-debugging" tabindex="-1">Improved Debugging <a class="header-anchor" href="#improved-debugging" aria-label="Permalink to “Improved Debugging”">​</a></h2><p>The <a href="https://vitest.dev/vscode" target="_blank" rel="noreferrer">vscode extension</a> now supports &quot;Debug Test&quot; button when running browser tests.</p><p>If you prefer configuring the debug options yourself, you can start Vitest with the <code>--inspect</code> flag (available with <code>playwright</code> and <code>webdriverio</code>) and connect to <a href="chrome://inspect/" target="_blank" rel="noreferrer">DevTools</a> manually. In this case Vitest will also disable the new <a href="/config/browser/trackunhandlederrors.html"><code>trackUnhandledErrors</code></a> option automatically.</p><h2 id="type-aware-hooks" tabindex="-1">Type-Aware Hooks <a class="header-anchor" href="#type-aware-hooks" aria-label="Permalink to “Type-Aware Hooks”">​</a></h2><p>When using <code>test.extend</code> with lifecycle hooks like <code>beforeEach</code> and <code>afterEach</code>, you can now reference them directly on the returned <code>test</code> object:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> baseTest } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> baseTest.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;{</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  todos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&gt;({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  todos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({}, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Unlike global hooks, these hooks are aware of the extended context</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">beforeEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">todos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  todos.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">afterEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">todos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(todos)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="expect-assert" tabindex="-1"><code>expect.assert</code> <a class="header-anchor" href="#expect-assert" aria-label="Permalink to “expect.assert”">​</a></h2><p>Vitest has always exported <a href="https://www.chaijs.com/api/assert/" target="_blank" rel="noreferrer">Chai&#39;s <code>assert</code></a>, but sometimes using it was inconvenient because many modules have the same export.</p><p>Now Vitest exposes the same method on <code>expect</code> for an easy access. This is especially useful if you need to narrow down the type, since <code>expect.to*</code> methods do not support that:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  __type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Cat&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  mew</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Dog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  __type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Dog&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  bark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Dog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { __type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Dog&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {} }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(animal.__type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Dog&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// does not show a type error!</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(animal.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bark</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeUndefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h2 id="expect-schemamatching" tabindex="-1"><code>expect.schemaMatching</code> <a class="header-anchor" href="#expect-schemamatching" aria-label="Permalink to “expect.schemaMatching”">​</a></h2><p>Vitest 4 introduces a new asymmetric matcher called <code>expect.schemaMatching</code>. It accepts a <a href="https://standardschema.dev/" target="_blank" rel="noreferrer">Standard Schema v1</a> object and validates values against it, passing the assertion when the value conforms to the schema.</p><p>As a reminder, asymmetric matchers can be used in all <code>expect</code> matchers that check equality, including <code>toEqual</code>, <code>toStrictEqual</code>, <code>toMatchObject</code>, <code>toContainEqual</code>, <code>toThrow</code>, <code>toHaveBeenCalledWith</code>, <code>toHaveReturnedWith</code> and <code>toHaveBeenResolvedWith</code>.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { expect, test } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { z } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;zod&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;valibot&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { type } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;arktype&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;email validation&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { email: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;john@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // using Zod</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email: expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">schemaMatching</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(z.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // using Valibot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email: expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">schemaMatching</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), v.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // using ArkType</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toEqual</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email: expect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">schemaMatching</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;string.email&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="reporter-updates" tabindex="-1">Reporter Updates <a class="header-anchor" href="#reporter-updates" aria-label="Permalink to “Reporter Updates”">​</a></h2><p>The <code>basic</code> reporter was removed. You can use the <code>default</code> reporter with <code>summary: false</code> instead:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reporters: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;default&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { summary: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>The <a href="/guide/reporters.html#default-reporter"><code>default</code></a> reporter now only prints tests in a tree if there is only one test file running. If you want to always see tests printed as a tree, you can use a new <a href="/guide/reporters.html#tree-reporter"><code>tree</code></a> reporter.</p><p>The <a href="/guide/reporters.html#verbose-reporter"><code>verbose</code></a> reporter now always prints tests one by one when they are finished. Previously, this was done only in CI, and locally <code>verbose</code> would behave mostly like a <code>default</code> reporter. If you prefer to keep the old behaviour, you can conditionally use the <code>verbose</code> reporter only in CI by updating the config:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vitest/config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  test: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reporter: process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CI</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;verbose&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;default&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="new-api-methods" tabindex="-1">New API Methods <a class="header-anchor" href="#new-api-methods" aria-label="Permalink to “New API Methods”">​</a></h2><p>Vitest 4 comes with new advanced public <a href="/api/advanced/vitest.html">API methods</a>:</p><ul><li><a href="/api/advanced/vitest.html#parsespecification"><code>experimental_parseSpecifications</code></a> allows you to parse a test file without running it.</li><li><a href="/api/advanced/vitest.html#watcher"><code>watcher</code></a> exposes methods that can be used when you disable the default Vitest watcher.</li><li><a href="/api/advanced/vitest.html#enablecoverage"><code>enableCoverage</code></a> and <a href="/api/advanced/vitest.html#disablecoverage"><code>disableCoverage</code></a> allow you to enable and disable coverage dynamically.</li><li><a href="/api/advanced/vitest.html#enablecoverage"><code>getSeed</code></a> returns the seed value, if tests run at random.</li><li><a href="/api/advanced/vitest.html#getglobaltestnamepattern"><code>getGlobalTestNamePattern</code></a> returns the current test name pattern.</li><li><a href="/api/advanced/vitest.html#waitfortestrunend"><code>waitForTestRunEnd</code></a> returns a promise that resolves when all tests have finished running.</li></ul><h2 id="breaking-changes" tabindex="-1">Breaking changes <a class="header-anchor" href="#breaking-changes" aria-label="Permalink to “Breaking changes”">​</a></h2><p>Vitest 4 has a few breaking changes that could affect you, so we advise reviewing the detailed <a href="/guide/migration.html#vitest-4">Migration Guide</a> before upgrading.</p><p>The complete list of changes is at the <a href="https://github.com/vitest-dev/vitest/releases/tag/v4.0.0" target="_blank" rel="noreferrer">Vitest 4 Changelog</a>.</p><h2 id="acknowledgments" tabindex="-1">Acknowledgments <a class="header-anchor" href="#acknowledgments" aria-label="Permalink to “Acknowledgments”">​</a></h2><p>Vitest 4 is the result of countless hours by the <a href="/team.html">Vitest team</a> and our contributors. We appreciate the individuals and companies sponsoring Vitest development. <a href="https://github.com/sheremet-va" target="_blank" rel="noreferrer">Vladimir</a> and <a href="https://github.com/hi-ogawa" target="_blank" rel="noreferrer">Hiroshi</a> are part of the <a href="https://voidzero.dev" target="_blank" rel="noreferrer">VoidZero</a> Team and are able to work on Vite and Vitest full-time, and <a href="https://github.com/ariperkkio" target="_blank" rel="noreferrer">Ari</a> can invest more time in Vitest thanks to <a href="https://stackblitz.com/" target="_blank" rel="noreferrer">StackBlitz</a>. A shout-out to <a href="https://nuxtlabs.com" target="_blank" rel="noreferrer">NuxtLabs</a>, <a href="https://zammad.com" target="_blank" rel="noreferrer">Zammad</a>, and sponsors on <a href="https://github.com/sponsors/vitest-dev" target="_blank" rel="noreferrer">Vitest&#39;s GitHub Sponsors</a> and <a href="https://opencollective.com/vitest" target="_blank" rel="noreferrer">Vitest&#39;s Open Collective</a>.</p></div></div></main><footer class="VPDocFooter" data-v-f57fb085 data-v-df38c4d5><!--[--><!--]--><div class="edit-info" data-v-df38c4d5><div class="edit-link" data-v-df38c4d5><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/vitest-dev/docs-cn/edit/dev/blog/vitest-4.md" target="_blank" rel="noreferrer" data-v-df38c4d5><!--[--><span class="vpi-square-pen edit-link-icon" data-v-df38c4d5></span> 在 GitHub 上编辑此页面<!--]--></a></div><div class="last-updated" data-v-df38c4d5><p class="VPLastUpdated" data-v-df38c4d5 data-v-c2d5b571>最后更新: <time datetime="2026-02-20T15:38:41.000Z" data-v-c2d5b571></time></p></div></div><!----></footer><!--[--><!--[--><!--[--><!--[--><div class="wwads-cn wwads-horizontal mt-4" data-id="354"></div><!--]--><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div></div><footer class="VPFooter" data-v-e9f02063 data-v-da53ccd1><div class="container" data-v-da53ccd1><!----><p class="copyright" data-v-da53ccd1>© 2026 VoidZero Inc. and Vitest contributors.</p></div></footer><!--[--><!--]--></div></div></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"advanced_pool.md\":\"NSIkz8EI\",\"api_advanced_artifacts.md\":\"CXyeghmx\",\"api_advanced_import-example.md\":\"vvOimxrs\",\"api_advanced_metadata.md\":\"BfycwofO\",\"api_advanced_plugin.md\":\"aIkjLCyJ\",\"api_advanced_reporters.md\":\"CsfYddhm\",\"api_advanced_runner.md\":\"Ci4PFs9M\",\"api_advanced_test-case.md\":\"RcZ9iQdi\",\"api_advanced_test-collection.md\":\"CrhHxzbk\",\"api_advanced_test-module.md\":\"DOeJTmiN\",\"api_advanced_test-project.md\":\"D9WrwrIJ\",\"api_advanced_test-specification.md\":\"BgRY60Eo\",\"api_advanced_test-suite.md\":\"JrjTiy2g\",\"api_advanced_vitest.md\":\"BJUreT74\",\"api_assert-type.md\":\"CCXx5HZi\",\"api_assert.md\":\"BgDGl_Og\",\"api_browser_assertions.md\":\"DSLKNrjX\",\"api_browser_commands.md\":\"DYVj7Kd5\",\"api_browser_context.md\":\"Cxgsqbog\",\"api_browser_interactivity.md\":\"WDaldehR\",\"api_browser_locators.md\":\"yDQFptHf\",\"api_browser_react.md\":\"B9ewpZK6\",\"api_browser_svelte.md\":\"D9u7rJlI\",\"api_browser_vue.md\":\"0Z7r2eTS\",\"api_describe.md\":\"DnTs4E4H\",\"api_expect-typeof.md\":\"Oyo0LuJJ\",\"api_expect.md\":\"KQdMMXFW\",\"api_hooks.md\":\"BK16y7fP\",\"api_index.md\":\"C1YPblht\",\"api_mock.md\":\"DkFnh5X_\",\"api_test.md\":\"C90B5e8e\",\"api_vi.md\":\"Do5ZiuZU\",\"blog.md\":\"UTVZh6hD\",\"blog_vitest-3-2.md\":\"DdZ7zTd7\",\"blog_vitest-3.md\":\"COptRSj-\",\"blog_vitest-4.md\":\"DGccDxcE\",\"config_alias.md\":\"CSNNd5kz\",\"config_allowonly.md\":\"cZsdkyd4\",\"config_api.md\":\"cmPXrPci\",\"config_attachmentsdir.md\":\"CZCHVJCh\",\"config_bail.md\":\"DJp2_JJ_\",\"config_benchmark.md\":\"BOKH7Ute\",\"config_browser_api.md\":\"EudKmpUk\",\"config_browser_commands.md\":\"BGptnYOf\",\"config_browser_connecttimeout.md\":\"t6Ibp8Gy\",\"config_browser_detailspanelposition.md\":\"BwUVTxV9\",\"config_browser_enabled.md\":\"CRsdaddd\",\"config_browser_expect.md\":\"Cp8-HV3m\",\"config_browser_headless.md\":\"CZwecIs8\",\"config_browser_instances.md\":\"CDJB_6yC\",\"config_browser_isolate.md\":\"CmhV5zYN\",\"config_browser_locators.md\":\"CrTpUqjI\",\"config_browser_orchestratorscripts.md\":\"B3JmcKkk\",\"config_browser_playwright.md\":\"BE1HO8pD\",\"config_browser_preview.md\":\"Cyp3L1YS\",\"config_browser_provider.md\":\"NrB3_3ne\",\"config_browser_screenshotdirectory.md\":\"CHGAuTHk\",\"config_browser_screenshotfailures.md\":\"CX-8FuJk\",\"config_browser_testerhtmlpath.md\":\"Cke_cu5q\",\"config_browser_trace.md\":\"DbpVL7LK\",\"config_browser_trackunhandlederrors.md\":\"CBFC3OqQ\",\"config_browser_ui.md\":\"C25XZgn4\",\"config_browser_viewport.md\":\"CPShBhOi\",\"config_browser_webdriverio.md\":\"CjPwe96H\",\"config_cache.md\":\"psKB9xGx\",\"config_chaiconfig.md\":\"DLwZMvnH\",\"config_clearmocks.md\":\"bokIy0Lo\",\"config_coverage.md\":\"D5CMvlGR\",\"config_css.md\":\"50X42uOg\",\"config_dangerouslyignoreunhandlederrors.md\":\"DoJG6zwz\",\"config_deps.md\":\"jWN5Hqqz\",\"config_detectasyncleaks.md\":\"qXyxZoIC\",\"config_diff.md\":\"-N1vCrma\",\"config_dir.md\":\"CR28CKDl\",\"config_disableconsoleintercept.md\":\"C3dbCTww\",\"config_env.md\":\"CgaS95OP\",\"config_environment.md\":\"x_Eds2RK\",\"config_environmentoptions.md\":\"D11raxMI\",\"config_exclude.md\":\"DPtVltQF\",\"config_execargv.md\":\"BvI4PAuI\",\"config_expandsnapshotdiff.md\":\"BKA3psnm\",\"config_expect.md\":\"DvQlHLIL\",\"config_experimental.md\":\"DZ9-LWrj\",\"config_faketimers.md\":\"Du39ELvL\",\"config_file.md\":\"B427aSwJ\",\"config_fileparallelism.md\":\"BO1tB4RZ\",\"config_forcereruntriggers.md\":\"DUDQDxnH\",\"config_globals.md\":\"DtwZS1Px\",\"config_globalsetup.md\":\"Cg1L8c26\",\"config_hideskippedtests.md\":\"DEGS9hi5\",\"config_hooktimeout.md\":\"DJxpXiKf\",\"config_include-source.md\":\"C96kd_lC\",\"config_include.md\":\"CRD7bzS4\",\"config_includetasklocation.md\":\"j1xdbERP\",\"config_index.md\":\"C-1HTqyL\",\"config_isolate.md\":\"DrJ_sDsi\",\"config_logheapusage.md\":\"ps4ngQz8\",\"config_maxconcurrency.md\":\"BHo7UieZ\",\"config_maxworkers.md\":\"BftKda5K\",\"config_mockreset.md\":\"CrLMR5a_\",\"config_mode.md\":\"CaIbDyRl\",\"config_name.md\":\"BXdTBIVG\",\"config_onconsolelog.md\":\"yQHNKgXP\",\"config_onstacktrace.md\":\"CJ9cUKNW\",\"config_onunhandlederror.md\":\"BbItrQF-\",\"config_open.md\":\"DUe5iIAT\",\"config_outputfile.md\":\"Dw9GTqNZ\",\"config_passwithnotests.md\":\"CuryoREG\",\"config_pool.md\":\"D_B0avxI\",\"config_printconsoletrace.md\":\"Cf2UOJpN\",\"config_projects.md\":\"D7m0xZAQ\",\"config_provide.md\":\"Cs7RCUtN\",\"config_reporters.md\":\"evgSmd5B\",\"config_resolvesnapshotpath.md\":\"Dqc90Qbd\",\"config_restoremocks.md\":\"C8gJAfJX\",\"config_retry.md\":\"BeporfR0\",\"config_root.md\":\"CYttY3-f\",\"config_runner.md\":\"BL0tRnIT\",\"config_sequence.md\":\"Csg8nzdh\",\"config_server.md\":\"B2JfFcR2\",\"config_setupfiles.md\":\"d5A_FAGu\",\"config_silent.md\":\"C_qx32oN\",\"config_slowtestthreshold.md\":\"9kWdz9kw\",\"config_snapshotenvironment.md\":\"1VsoK20j\",\"config_snapshotformat.md\":\"Dazd3UVb\",\"config_snapshotserializers.md\":\"B92iYe-4\",\"config_stricttags.md\":\"DW6dhV7P\",\"config_tags.md\":\"Cppfvi9_\",\"config_teardowntimeout.md\":\"HIkkWEZc\",\"config_testnamepattern.md\":\"DqpoBEDR\",\"config_testtimeout.md\":\"C7g-3VDc\",\"config_typecheck.md\":\"BtgDrXnw\",\"config_ui.md\":\"DBdBWpxI\",\"config_unstubenvs.md\":\"WYIY1OWK\",\"config_unstubglobals.md\":\"C5jWROdp\",\"config_update.md\":\"CahZgTer\",\"config_vmmemorylimit.md\":\"CSbszuPI\",\"config_watch.md\":\"BeCFk10q\",\"config_watchtriggerpatterns.md\":\"Dka17aUA\",\"guide_advanced_index.md\":\"DRUkqyV1\",\"guide_advanced_pool.md\":\"DQtR04q3\",\"guide_advanced_reporters.md\":\"Dwz2zuI0\",\"guide_advanced_tests.md\":\"D8gr8eMx\",\"guide_browser_component-testing.md\":\"Dy4fZMmp\",\"guide_browser_index.md\":\"Bw-NcQ0b\",\"guide_browser_multiple-setups.md\":\"C9NUEhhB\",\"guide_browser_retry-ability.md\":\"Bc4i3ZMk\",\"guide_browser_trace-view.md\":\"Dj5ZihSB\",\"guide_browser_visual-regression-testing.md\":\"BNQ6JopT\",\"guide_browser_why.md\":\"DSs4ojfk\",\"guide_cli-table.md\":\"BJW1ZnBG\",\"guide_cli.md\":\"D045u2L7\",\"guide_common-errors.md\":\"ooxukC2k\",\"guide_comparisons.md\":\"BZsFfFBA\",\"guide_coverage.md\":\"DasIITDg\",\"guide_debugging.md\":\"BSjeWp68\",\"guide_environment.md\":\"DnZbyZk7\",\"guide_extending-matchers.md\":\"Bo6qNijQ\",\"guide_features.md\":\"DjzWwQWW\",\"guide_filtering.md\":\"CSVAJCNh\",\"guide_ide.md\":\"Dhq5IC4Y\",\"guide_improving-performance.md\":\"CwnwEvme\",\"guide_in-source.md\":\"BODAGD7S\",\"guide_index.md\":\"C7QPM-y5\",\"guide_lifecycle.md\":\"D7q6hvEa\",\"guide_migration.md\":\"tz2BwIor\",\"guide_mocking.md\":\"CkRkmkmp\",\"guide_mocking_classes.md\":\"D5AMOJl2\",\"guide_mocking_dates.md\":\"BTQAcs1b\",\"guide_mocking_file-system.md\":\"C1mwa2bk\",\"guide_mocking_functions.md\":\"DwpTtF5r\",\"guide_mocking_globals.md\":\"FXfnAhW6\",\"guide_mocking_modules.md\":\"BHUNJgJD\",\"guide_mocking_requests.md\":\"D-R_mZ7P\",\"guide_mocking_timers.md\":\"D_-8jh6X\",\"guide_open-telemetry.md\":\"Dd33iHhF\",\"guide_parallelism.md\":\"zJGBZUPO\",\"guide_profiling-test-performance.md\":\"CELPYyKu\",\"guide_projects.md\":\"BU8Cl6uS\",\"guide_recipes.md\":\"D2nV2UCm\",\"guide_reporters.md\":\"BiJCnff8\",\"guide_snapshot.md\":\"GZE9Kgbu\",\"guide_test-annotations.md\":\"COY7iFms\",\"guide_test-context.md\":\"CXZWDVKV\",\"guide_test-tags.md\":\"D4zbYfpD\",\"guide_testing-types.md\":\"Bo5NzktO\",\"guide_ui.md\":\"rJonp2bZ\",\"guide_using-plugins.md\":\"DK4OvJSo\",\"guide_why.md\":\"BhrGkgCz\",\"index.md\":\"70hIzX0y\",\"readme.md\":\"LQ47oLG-\",\"team.md\":\"DHsFiIc1\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Vitest 中文文档\",\"description\":\"由 Vite 驱动的下一代测试框架\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"variant\":\"vitest\",\"logo\":\"/logo.svg\",\"lastUpdatedText\":\"最后更新\",\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"editLink\":{\"pattern\":\"https://github.com/vitest-dev/docs-cn/edit/dev/:path\",\"text\":\"在 GitHub 上编辑此页面\"},\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"搜索\"},\"modal\":{\"resetButtonTitle\":\"清除查询条件\",\"noResultsText\":\"无法找到相关结果\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\"}}}}},\"socialLinks\":[{\"icon\":\"bluesky\",\"link\":\"https://bsky.app/profile/vitest.dev\"},{\"icon\":\"mastodon\",\"link\":\"https://elk.zone/m.webtoo.ls/@vitest\"},{\"icon\":\"discord\",\"link\":\"https://chat.vitest.dev\"},{\"icon\":\"github\",\"link\":\"https://github.com/vitest-dev/vitest\"}],\"footer\":{\"copyright\":\"© 2026 VoidZero Inc. and Vitest contributors.\",\"nav\":[{\"title\":\"Vitest\",\"items\":[{\"text\":\"Guides\",\"link\":\"/guide/\"},{\"text\":\"API\",\"link\":\"/api/test\"},{\"text\":\"Config\",\"link\":\"/config/\"}]},{\"title\":\"资源\",\"items\":[{\"text\":\"团队\",\"link\":\"/team\"},{\"text\":\"博客\",\"link\":\"/blog\"},{\"text\":\"更新日志\",\"link\":\"https://github.com/vitest-dev/vitest/releases\"}]},{\"title\":\"版本\",\"items\":[{\"text\":\"未发布\",\"link\":\"https://main.vitest.dev/\"},{\"text\":\"Vitest v3 文档\",\"link\":\"https://v3.cn.vitest.dev/\"},{\"text\":\"Vitest v2 文档\",\"link\":\"https://v2.vitest.dev/\"},{\"text\":\"Vitest v1 文档\",\"link\":\"https://v1.vitest.dev/\"},{\"text\":\"Vitest v0 文档\",\"link\":\"https://v0.vitest.dev/\"}]}],\"social\":[{\"icon\":\"github\",\"link\":\"https://github.com/vitest-dev/vitest\"},{\"icon\":\"discord\",\"link\":\"https://chat.vitest.dev\"},{\"icon\":\"bluesky\",\"link\":\"https://bsky.app/profile/vitest.dev\"}]},\"nav\":[{\"text\":\"指南\",\"link\":\"/guide/\",\"activeMatch\":\"^/guide/\"},{\"text\":\"API\",\"link\":\"/api/test\",\"activeMatch\":\"^/api/\"},{\"text\":\"配置\",\"link\":\"/config/\",\"activeMatch\":\"^/config/\"},{\"text\":\"博客\",\"link\":\"/blog\"},{\"text\":\"v4.0.17\",\"items\":[{\"items\":[{\"text\":\"v4.0.17\",\"link\":\"https://github.com/vitest-dev/vitest/releases/tag/v4.0.17\"},{\"text\":\"更新日志\",\"link\":\"https://github.com/vitest-dev/vitest/releases\"},{\"text\":\"贡献指南\",\"link\":\"https://github.com/vitest-dev/vitest/blob/main/CONTRIBUTING.md\"},{\"text\":\"团队\",\"link\":\"/team\"}]},{\"items\":[{\"text\":\"未发布\",\"link\":\"https://main.vitest.dev/\"},{\"text\":\"v3.x\",\"link\":\"https://v3.cn.vitest.dev/\"},{\"text\":\"v2.x\",\"link\":\"https://v2.vitest.dev/\"},{\"text\":\"v1.x\",\"link\":\"https://v1.vitest.dev/\"},{\"text\":\"v0.x\",\"link\":\"https://v0.vitest.dev/\"}]}]}],\"sidebar\":{\"/config\":[{\"text\":\"Config Reference\",\"collapsed\":false,\"items\":[{\"text\":\"配置文件\",\"link\":\"/config/\"},{\"text\":\"include\",\"link\":\"/config/include\"},{\"text\":\"exclude\",\"link\":\"/config/exclude\"},{\"text\":\"includeSource\",\"link\":\"/config/include-source\"},{\"text\":\"name\",\"link\":\"/config/name\"},{\"text\":\"server\",\"link\":\"/config/server\"},{\"text\":\"deps\",\"link\":\"/config/deps\"},{\"text\":\"runner\",\"link\":\"/config/runner\"},{\"text\":\"benchmark\",\"link\":\"/config/benchmark\"},{\"text\":\"alias\",\"link\":\"/config/alias\"},{\"text\":\"globals\",\"link\":\"/config/globals\"},{\"text\":\"environment\",\"link\":\"/config/environment\"},{\"text\":\"environmentOptions\",\"link\":\"/config/environmentoptions\"},{\"text\":\"watch\",\"link\":\"/config/watch\"},{\"text\":\"watchTriggerPatterns\",\"link\":\"/config/watchtriggerpatterns\"},{\"text\":\"root\",\"link\":\"/config/root\"},{\"text\":\"dir\",\"link\":\"/config/dir\"},{\"text\":\"reporters\",\"link\":\"/config/reporters\"},{\"text\":\"outputFile\",\"link\":\"/config/outputfile\"},{\"text\":\"pool\",\"link\":\"/config/pool\"},{\"text\":\"execArgv\",\"link\":\"/config/execargv\"},{\"text\":\"vmMemoryLimit\",\"link\":\"/config/vmmemorylimit\"},{\"text\":\"fileParallelism\",\"link\":\"/config/fileparallelism\"},{\"text\":\"maxWorkers\",\"link\":\"/config/maxworkers\"},{\"text\":\"testTimeout\",\"link\":\"/config/testtimeout\"},{\"text\":\"hookTimeout\",\"link\":\"/config/hooktimeout\"},{\"text\":\"teardownTimeout\",\"link\":\"/config/teardowntimeout\"},{\"text\":\"silent\",\"link\":\"/config/silent\"},{\"text\":\"setupFiles\",\"link\":\"/config/setupfiles\"},{\"text\":\"provide\",\"link\":\"/config/provide\"},{\"text\":\"globalSetup\",\"link\":\"/config/globalsetup\"},{\"text\":\"forceRerunTriggers\",\"link\":\"/config/forcereruntriggers\"},{\"text\":\"coverage\",\"link\":\"/config/coverage\"},{\"text\":\"testNamePattern\",\"link\":\"/config/testnamepattern\"},{\"text\":\"ui\",\"link\":\"/config/ui\"},{\"text\":\"open\",\"link\":\"/config/open\"},{\"text\":\"api\",\"link\":\"/config/api\"},{\"text\":\"clearMocks\",\"link\":\"/config/clearmocks\"},{\"text\":\"mockReset\",\"link\":\"/config/mockreset\"},{\"text\":\"restoreMocks\",\"link\":\"/config/restoremocks\"},{\"text\":\"unstubEnvs\",\"link\":\"/config/unstubenvs\"},{\"text\":\"unstubGlobals\",\"link\":\"/config/unstubglobals\"},{\"text\":\"snapshotFormat\",\"link\":\"/config/snapshotformat\"},{\"text\":\"snapshotSerializers\",\"link\":\"/config/snapshotserializers\"},{\"text\":\"resolveSnapshotPath\",\"link\":\"/config/resolvesnapshotpath\"},{\"text\":\"allowOnly\",\"link\":\"/config/allowonly\"},{\"text\":\"passWithNoTests\",\"link\":\"/config/passwithnotests\"},{\"text\":\"logHeapUsage\",\"link\":\"/config/logheapusage\"},{\"text\":\"css\",\"link\":\"/config/css\"},{\"text\":\"maxConcurrency\",\"link\":\"/config/maxconcurrency\"},{\"text\":\"cache\",\"link\":\"/config/cache\"},{\"text\":\"sequence\",\"link\":\"/config/sequence\"},{\"text\":\"tags\",\"link\":\"/config/tags\"},{\"text\":\"strictTags\",\"link\":\"/config/stricttags\"},{\"text\":\"typecheck\",\"link\":\"/config/typecheck\"},{\"text\":\"slowTestThreshold\",\"link\":\"/config/slowtestthreshold\"},{\"text\":\"chaiConfig\",\"link\":\"/config/chaiconfig\"},{\"text\":\"bail\",\"link\":\"/config/bail\"},{\"text\":\"retry\",\"link\":\"/config/retry\"},{\"text\":\"onConsoleLog\",\"link\":\"/config/onconsolelog\"},{\"text\":\"onStackTrace\",\"link\":\"/config/onstacktrace\"},{\"text\":\"onUnhandledError\",\"link\":\"/config/onunhandlederror\"},{\"text\":\"dangerouslyIgnoreUnhandled...\",\"link\":\"/config/dangerouslyignoreunhandlederrors\"},{\"text\":\"diff\",\"link\":\"/config/diff\"},{\"text\":\"fakeTimers\",\"link\":\"/config/faketimers\"},{\"text\":\"projects\",\"link\":\"/config/projects\"},{\"text\":\"isolate\",\"link\":\"/config/isolate\"},{\"text\":\"includeTaskLocation\",\"link\":\"/config/includetasklocation\"},{\"text\":\"snapshotEnvironment\",\"link\":\"/config/snapshotenvironment\"},{\"text\":\"env\",\"link\":\"/config/env\"},{\"text\":\"expect\",\"link\":\"/config/expect\"},{\"text\":\"printConsoleTrace\",\"link\":\"/config/printconsoletrace\"},{\"text\":\"attachmentsDir\",\"link\":\"/config/attachmentsdir\"},{\"text\":\"hideSkippedTests\",\"link\":\"/config/hideskippedtests\"},{\"text\":\"mode\",\"link\":\"/config/mode\"},{\"text\":\"expandSnapshotDiff\",\"link\":\"/config/expandsnapshotdiff\"},{\"text\":\"disableConsoleIntercept\",\"link\":\"/config/disableconsoleintercept\"},{\"text\":\"experimental\",\"link\":\"/config/experimental\"}]},{\"text\":\"Browser Mode\",\"collapsed\":false,\"items\":[{\"text\":\"Providers\",\"collapsed\":false,\"items\":[{\"text\":\"playwright\",\"link\":\"/config/browser/playwright\"},{\"text\":\"webdriverio\",\"link\":\"/config/browser/webdriverio\"},{\"text\":\"preview\",\"link\":\"/config/browser/preview\"}]},{\"text\":\"browser.enabled\",\"link\":\"/config/browser/enabled\"},{\"text\":\"browser.instances\",\"link\":\"/config/browser/instances\"},{\"text\":\"browser.headless\",\"link\":\"/config/browser/headless\"},{\"text\":\"browser.isolate\",\"link\":\"/config/browser/isolate\"},{\"text\":\"browser.testerHtmlPath\",\"link\":\"/config/browser/testerhtmlpath\"},{\"text\":\"browser.api\",\"link\":\"/config/browser/api\"},{\"text\":\"browser.provider\",\"link\":\"/config/browser/provider\"},{\"text\":\"browser.ui\",\"link\":\"/config/browser/ui\"},{\"text\":\"browser.detailsPanelPosition\",\"link\":\"/config/browser/detailspanelposition\"},{\"text\":\"browser.viewport\",\"link\":\"/config/browser/viewport\"},{\"text\":\"browser.locators\",\"link\":\"/config/browser/locators\"},{\"text\":\"browser.screenshotDirectory\",\"link\":\"/config/browser/screenshotdirectory\"},{\"text\":\"browser.screenshotFailures\",\"link\":\"/config/browser/screenshotfailures\"},{\"text\":\"browser.orchestratorScripts\",\"link\":\"/config/browser/orchestratorscripts\"},{\"text\":\"browser.commands\",\"link\":\"/config/browser/commands\"},{\"text\":\"browser.connectTimeout\",\"link\":\"/config/browser/connecttimeout\"},{\"text\":\"browser.trace\",\"link\":\"/config/browser/trace\"},{\"text\":\"browser.trackUnhandledErrors\",\"link\":\"/config/browser/trackunhandlederrors\"},{\"text\":\"browser.expect\",\"link\":\"/config/browser/expect\"}]}],\"/guide\":[{\"text\":\"简介\",\"collapsed\":false,\"items\":[{\"text\":\"为什么是 Vitest?\",\"link\":\"/guide/why\"},{\"text\":\"快速起步\",\"link\":\"/guide/\"},{\"text\":\"主要功能\",\"link\":\"/guide/features\"}]},{\"text\":\"浏览器模式\",\"collapsed\":false,\"items\":[{\"text\":\"什么是浏览器模式？\",\"link\":\"/guide/browser/why\",\"docFooterText\":\"什么是浏览器模式？ | 浏览器模式\"},{\"text\":\"快速起步\",\"link\":\"/guide/browser/\",\"docFooterText\":\"快速起步 | 浏览器模式\"},{\"text\":\"多环境配置\",\"link\":\"/guide/browser/multiple-setups\",\"docFooterText\":\"多环境配置 | 浏览器模式\"},{\"text\":\"组件测试\",\"link\":\"/guide/browser/component-testing\",\"docFooterText\":\"组件测试 | 浏览器模式\"},{\"text\":\"可视化回归测试\",\"link\":\"/guide/browser/visual-regression-testing\",\"docFooterText\":\"可视化回归测试 | 浏览器模式\"},{\"text\":\"追踪查看器\",\"link\":\"/guide/browser/trace-view\",\"docFooterText\":\"追踪查看器 | 浏览器模式\"}]},{\"text\":\"指南\",\"collapsed\":false,\"items\":[{\"text\":\"命令行界面\",\"link\":\"/guide/cli\"},{\"text\":\"测试筛选\",\"link\":\"/guide/filtering\"},{\"text\":\"测试标签\",\"link\":\"/guide/test-tags\"},{\"text\":\"测试上下文\",\"link\":\"/guide/test-context\"},{\"text\":\"测试环境\",\"link\":\"/guide/environment\"},{\"text\":\"Test Run Lifecycle\",\"link\":\"/guide/lifecycle\"},{\"text\":\"快照\",\"link\":\"/guide/snapshot\"},{\"text\":\"模拟对象\",\"link\":\"/guide/mocking\",\"collapsed\":true,\"items\":[{\"text\":\"模拟日期\",\"link\":\"/guide/mocking/dates\"},{\"text\":\"模拟函数\",\"link\":\"/guide/mocking/functions\"},{\"text\":\"模拟全局对象\",\"link\":\"/guide/mocking/globals\"},{\"text\":\"模拟模块\",\"link\":\"/guide/mocking/modules\"},{\"text\":\"模拟文件系统\",\"link\":\"/guide/mocking/file-system\"},{\"text\":\"模拟请求\",\"link\":\"/guide/mocking/requests\"},{\"text\":\"模拟计时器\",\"link\":\"/guide/mocking/timers\"},{\"text\":\"模拟类\",\"link\":\"/guide/mocking/classes\"}]},{\"text\":\"并行测试\",\"link\":\"/guide/parallelism\"},{\"text\":\"测试项目\",\"link\":\"/guide/projects\"},{\"text\":\"报告器\",\"link\":\"/guide/reporters\"},{\"text\":\"覆盖率\",\"link\":\"/guide/coverage\"},{\"text\":\"类型测试\",\"link\":\"/guide/testing-types\"},{\"text\":\"UI 模式\",\"link\":\"/guide/ui\"},{\"text\":\"内联测试\",\"link\":\"/guide/in-source\"},{\"text\":\"测试注释\",\"link\":\"/guide/test-annotations\"},{\"text\":\"扩展断言\",\"link\":\"/guide/extending-matchers\"},{\"text\":\"IDE 插件\",\"link\":\"/guide/ide\"},{\"text\":\"调试\",\"link\":\"/guide/debugging\"},{\"text\":\"常见错误\",\"link\":\"/guide/common-errors\"},{\"text\":\"迁移指南\",\"link\":\"/guide/migration\",\"collapsed\":false,\"items\":[{\"text\":\"迁移到 Vitest 4\",\"link\":\"/guide/migration#vitest-4\"},{\"text\":\"从 Jest 迁移\",\"link\":\"/guide/migration#jest\"},{\"text\":\"Migrating from Mocha + Chai + Sinon\",\"link\":\"/guide/migration#mocha-chai-sinon\"}]},{\"text\":\"性能\",\"collapsed\":false,\"items\":[{\"text\":\"性能测试分析\",\"link\":\"/guide/profiling-test-performance\"},{\"text\":\"性能优化\",\"link\":\"/guide/improving-performance\"}]},{\"text\":\"OpenTelemetry\",\"link\":\"/guide/open-telemetry\"}]},{\"text\":\"高级指南\",\"collapsed\":true,\"items\":[{\"text\":\"快速开始\",\"link\":\"/guide/advanced/\"},{\"text\":\"运行测试 API\",\"link\":\"/guide/advanced/tests\"},{\"text\":\"扩展报告器\",\"link\":\"/guide/advanced/reporters\"},{\"text\":\"自定义运行池\",\"link\":\"/guide/advanced/pool\"}]},{\"items\":[{\"text\":\"测试技巧\",\"link\":\"/guide/recipes\"},{\"text\":\"测试框架比较\",\"link\":\"/guide/comparisons\"}]}],\"/api\":[{\"text\":\"Test API\",\"items\":[{\"text\":\"Test\",\"link\":\"/api/test\"},{\"text\":\"Describe\",\"link\":\"/api/describe\"},{\"text\":\"Hooks\",\"link\":\"/api/hooks\"}]},{\"text\":\"Mocks\",\"link\":\"/api/mock\"},{\"text\":\"Vi Utility\",\"link\":\"/api/vi\"},{\"text\":\"Expect\",\"link\":\"/api/expect\"},{\"text\":\"ExpectTypeOf\",\"link\":\"/api/expect-typeof\"},{\"text\":\"Assert\",\"link\":\"/api/assert\"},{\"text\":\"AssertType\",\"link\":\"/api/assert-type\"},{\"text\":\"浏览器模式\",\"items\":[{\"text\":\"Render Function\",\"collapsed\":false,\"items\":[{\"text\":\"react\",\"link\":\"/api/browser/react\"},{\"text\":\"vue\",\"link\":\"/api/browser/vue\"},{\"text\":\"svelte\",\"link\":\"/api/browser/svelte\"}]},{\"text\":\"Context API\",\"link\":\"/api/browser/context\"},{\"text\":\"Interactivity API\",\"link\":\"/api/browser/interactivity\"},{\"text\":\"Locators\",\"link\":\"/api/browser/locators\"},{\"text\":\"Assertions API\",\"link\":\"/api/browser/assertions\"},{\"text\":\"Commands API\",\"link\":\"/api/browser/commands\"}]},{\"text\":\"高级 API\",\"collapsed\":true,\"items\":[{\"text\":\"Vitest\",\"link\":\"/api/advanced/vitest\"},{\"text\":\"TestProject\",\"link\":\"/api/advanced/test-project\"},{\"text\":\"TestSpecification\",\"link\":\"/api/advanced/test-specification\"},{\"text\":\"TestCase\",\"link\":\"/api/advanced/test-case\"},{\"text\":\"TestSuite\",\"link\":\"/api/advanced/test-suite\"},{\"text\":\"TestModule\",\"link\":\"/api/advanced/test-module\"},{\"text\":\"TestCollection\",\"link\":\"/api/advanced/test-collection\"},{\"text\":\"VitestPlugin\",\"link\":\"/api/advanced/plugin\"},{\"text\":\"VitestRunner\",\"link\":\"/api/advanced/runner\"},{\"text\":\"Reporter\",\"link\":\"/api/advanced/reporters\"},{\"text\":\"TaskMeta\",\"link\":\"/api/advanced/metadata\"},{\"text\":\"TestArtifact\",\"link\":\"/api/advanced/artifacts\"}]}]}},\"locales\":{\"root\":{\"label\":\"简体中文\",\"lang\":\"zh\"},\"zh\":{\"label\":\"English\",\"lang\":\"en-US\",\"link\":\"https://vitest.dev/\"}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>